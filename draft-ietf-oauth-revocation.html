<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- saved from url=(0077)file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html -->
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"><head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/"><meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
  

  <title>Token Revocation</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  max-width: 55em;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.toc" rel="Contents">
<link href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.section.2" rel="Chapter" title="2 Token Revocation">
<link href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.section.2.1" rel="Chapter" title="2.1 Revocation Request">
<link href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.section.2.2" rel="Chapter" title="2.2 Revocation Response">
<link href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.section.2.2.1" rel="Chapter" title="2.2.1 Error Response">
<link href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.section.2.3" rel="Chapter" title="2.3 Cross-Origin Support">
<link href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.section.3" rel="Chapter" title="3 Implementation Note">
<link href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.section.4" rel="Chapter" title="4 Acknowledgements">
<link href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.section.5" rel="Chapter" title="5 IANA Considerations">
<link href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.section.5.1" rel="Chapter" title="5.1 OAuth Extensions Error Registration">
<link href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.section.5.1.1" rel="Chapter" title="5.1.1 The &quot;unsupported_token_type&quot; Error Value">
<link href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.section.6" rel="Chapter" title="6 Security Considerations">
<link href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.references" rel="Chapter" title="7 References">
<link href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.references.1" rel="Chapter" title="7.1 Normative References">
<link href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.references.2" rel="Chapter" title="7.2 Informative References">
<link href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 2.4.0 - http://tools.ietf.org/tools/xml2rfc">
  <link rel="schema.dct" href="http://purl.org/dc/terms/">

  <meta name="dct.creator" content="Lodderstedt, T., Ed., Dronia, S., and M. Scurtescu ">
  <meta name="dct.identifier" content="urn:ietf:id:draft-ietf-oauth-revocation-06">
  <meta name="dct.issued" scheme="ISO8601" content="2013-4-07">
  <meta name="dct.abstract" content="This document proposes an additional endpoint for OAuth authorization servers, which allows clients to notify the authorization server that a previously obtained refresh or access token is no longer needed. This allows the authorization server to cleanup security credentials. A revocation request will invalidate the actual token and, if applicable, other tokens based on the same authorization grant.">
  <meta name="description" content="This document proposes an additional endpoint for OAuth authorization servers, which allows clients to notify the authorization server that a previously obtained refresh or access token is no longer needed. This allows the authorization server to cleanup security credentials. A revocation request will invalidate the actual token and, if applicable, other tokens based on the same authorization grant.">

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
  <td class="left">OAuth Working Group</td>
  <td class="right">T. Lodderstedt, Ed.</td>
</tr>
<tr>
  <td class="left">Internet-Draft</td>
  <td class="right">Deutsche Telekom AG</td>
</tr>
<tr>
  <td class="left">Intended status: Standards Track</td>
  <td class="right">S. Dronia</td>
</tr>
<tr>
  <td class="left">Expires: October 09, 2013</td>
  <td class="right">M. Scurtescu</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">Google</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">April 07, 2013</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Token Revocation<br>
  <span class="filename">draft-ietf-oauth-revocation-06</span></p>
  
  <h1 id="rfc.abstract">
  <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.abstract">Abstract</a>
</h1>
<p>This document proposes an additional endpoint for OAuth authorization servers, which allows clients to notify the authorization server that a previously obtained refresh or access token is no longer needed. This allows the authorization server to cleanup security credentials. A revocation request will invalidate the actual token and, if applicable, other tokens based on the same authorization grant.</p>
<h1>
  <a>Requirements Language</a>
</h1>
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#RFC2119">RFC 2119</a> <cite title="NONE">[RFC2119]</cite>.</p>
<h1 id="rfc.status">
  <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.status">Status of This Memo</a>
</h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on October 09, 2013.</p>
<h1 id="rfc.copyrightnotice">
  <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.copyrightnotice">Copyright Notice</a>
</h1>
<p>Copyright (c) 2013 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint">
  <h1 class="np" id="rfc.toc"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.section.1">Introduction</a></li>
<li>2.   <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.section.2">Token Revocation</a></li>
<li>2.1.   <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.section.2.1">Revocation Request</a></li>
<li>2.2.   <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.section.2.2">Revocation Response</a></li>
<li>2.2.1.   <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.section.2.2.1">Error Response</a></li>
<li>2.3.   <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.section.2.3">Cross-Origin Support</a></li>
<li>3.   <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.section.3">Implementation Note</a></li>
<li>4.   <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.section.4">Acknowledgements</a></li>
<li>5.   <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.section.5">IANA Considerations</a></li>
<li>5.1.   <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.section.5.1">OAuth Extensions Error Registration</a></li>
<li>5.1.1.   <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.section.5.1.1">The "unsupported_token_type" Error Value</a></li>
<li>6.   <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.section.6">Security Considerations</a></li>
<li>7.   <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.references">References</a></li>
<li>7.1.   <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.references.1">Normative References</a></li>
<li>7.2.   <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.references.2">Informative References</a></li>
<li><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.authors">Authors' Addresses</a></li>


  </ul>

  <h1 id="rfc.section.1"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.section.1">1.</a> <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#Introduction" id="Introduction">Introduction</a></h1>
<p id="rfc.section.1.p.1">The OAuth 2.0 core specification <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#RFC6749">[RFC6749]</a> defines several ways for a client to obtain refresh and access tokens. This specification supplements the core specification with a mechanism to revoke both types of tokens. A token is a string representing an authorization grant issued by the resource owner to the client. A revocation request will invalidate the actual token and, if applicable, other tokens based on the same authorization grant and the authorization grant itself.</p>
<p id="rfc.section.1.p.2">From an end-user's perspective, OAuth is often used to log into a certain site or app. This revocation mechanism allows a client to invalidate its tokens if the end-user logs out, changes identity, or uninstalls the respective app. Notifying the authorization server that the token is no longer needed allows the authorization server to clean up data associated with that token (e.g. session data) and the underlying authorization grant. This behavior prevents a situation where there is still a valid authorization grant for a particular client which the end user is not aware of. This way, token revocation prevents abuse of abandoned tokens and facilitates a better end-user experience since invalidated authorization grants will no longer turn up in a list of authorization grants the authorization server might present to the end-user.</p>
<h1 id="rfc.section.2"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.section.2">2.</a> <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#Revocation" id="Revocation">Token Revocation</a></h1>
<p id="rfc.section.2.p.1">Implementations MUST support the revocation of refresh tokens and SHOULD support the revocation of access tokens (see <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#impl">Implementation Note</a>).</p>
<p id="rfc.section.2.p.2">The client requests the revocation of a particular token by making an HTTP POST request to the token revocation endpoint URL. The token endpoint URL MAY include a query component. The means to obtain the location of the revocation endpoint is out of scope of this specification. For example, the client developler may consult the server's documentation or automatic discovery may be used. As this endpoint is handling security credentials, the endpoint location MUST be obtained from a trustworthy source.</p>
<p id="rfc.section.2.p.3">Since requests to the token revocation endpoint result in the transmission of plain text credentials in the HTTP request, the authorization server MUST require the use of a transport-layer security mechanism when sending requests to the token revocation endpoints. The authorization server MUST support TLS 1.0 (<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#RFC2246">[RFC2246]</a>), SHOULD support TLS 1.2 (<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#RFC5246">[RFC5246]</a>) and its future replacements, and MAY support additional transport-layer mechanisms meeting its security requirements.</p>
<h1 id="rfc.section.2.1"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.section.2.1">2.1.</a> Revocation Request</h1>
<p id="rfc.section.2.1.p.1">The client constructs the request by including the following parameters using the "application/x-www-form-urlencoded" format in the HTTP request entity-body:</p>
<p><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#RFC6749">[RFC6749]</a>.</p>

<dl>
  <dt>token</dt>
  <dd style="margin-left: 8">REQUIRED. The token that the client wants to get revoked.</dd>
  <dt>token_type_hint</dt>
  <dd style="margin-left: 8">OPTIONAL. A hint about the type of the token submitted for revocation. Clients MAY pass this parameter in order to help the authorization server to optimize the token lookup. If the server is unable to locate the token using the given hint, it MUST extend its search accross all of its supported token types. An authorization server MAY ignore this parameter, particularly if it is able to detect the token type automatically. This specification defines two such values:</dd>
  <dt></dt>
  <dd style="margin-left: 8">
    <ul>
      <li>access_token An Access Token as defined in <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#RFC6749">[RFC6749]</a> section 1.4</li>
      <li>refresh_token A Refresh Token as defined in <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#RFC6749">[RFC6749]</a> section 1.5</li>
    </ul>
    <p>Specific implementations, profiles, and extensions of this specification MAY define other values for this parameter.</p>
  </dd>
</dl>

<p>The client also includes its authentication credentials as described in Section 2.3. of </p>
<p id="rfc.section.2.1.p.3">For example, a client may request the revocation of a refresh token with the following request (line breaks are for display purposes only):</p>
<pre>  POST /revoke HTTP/1.1
  Host: server.example.com
  Content-Type: application/x-www-form-urlencoded
  Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
     
  token=45ghiukldjahdnhzdauz&amp;token_type_hint=refresh_token</pre>
<p class="figure"></p>
<p id="rfc.section.2.1.p.4">The authorization server first validates the client credentials (in case of a confidential client) and then verifies whether the token was issued to the client making the revocation request. If this validation fails, the request is refused and the client is informed of the error by the authorization server as described below.</p>
<p id="rfc.section.2.1.p.5">In the next step, the authorization server invalidates the token. The client MUST assume the revocation is immediate upon the return of the request. The client MUST NOT use the token again after the revocation.</p>
<p id="rfc.section.2.1.p.6">Depending on the authorization server's revocation policy, the revocation of a particular token may cause the revocation of related tokens and the underlying authorization grant. If the particular token is a refresh token and the authorization server supports the revocation of access tokens, then the authorization server SHOULD also invalidate all access tokens based on the same authorization grant (see <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#impl">Implementation Note</a>). If the token passed to the request is an access token, the server MAY decide to revoke the respective refresh token as well.</p>
<p id="rfc.section.2.1.p.7">Note: A client compliant with <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#RFC6749">[RFC6749]</a> must be prepared to handle unexpected token invalidation at any time. Independent of the revocation mechanism specified in this document, resource owners may decide to revoke authorization grants or the authorization server may invalidate tokens in order to mitigate security threats. Thus having different server policies with respect to cascading the revocation of tokens should not pose interoperability problems.</p>
<h1 id="rfc.section.2.2"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.section.2.2">2.2.</a> Revocation Response</h1>
<p id="rfc.section.2.2.p.1">The authorization server indicates a successful processing of the request by a HTTP status code 200. This also applies if the client submits an invalid token to the revocation endpoint.</p>
<h1 id="rfc.section.2.2.1"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.section.2.2.1">2.2.1.</a> Error Response</h1>
<p id="rfc.section.2.2.1.p.1">The error presentation conforms to the defintion in section 5.2 of <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#RFC6749">[RFC6749]</a>. The following additional error code is defined for the token revocation endpoint: </p>

<dl>
  <dt>unsupported_token_type</dt>
  <dd style="margin-left: 8">The authorization server does not support the revocation of the presented token type. I.e. the client tried to revoke an access token on a server not supporting this feature.</dd>
</dl>
<h1 id="rfc.section.2.3"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.section.2.3">2.3.</a> <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#cross-orgin" id="cross-orgin">Cross-Origin Support</a></h1>
<p id="rfc.section.2.3.p.1">The revocation end-point MAY support <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#W3C.WD-cors-20120403">CORS</a> <cite title="NONE">[W3C.WD-cors-20120403]</cite> if it is aimed at use in combination with user-agent-based applications.</p>
<p id="rfc.section.2.3.p.2">In addition, for interoperability with legacy user-agents, it MAY also offer <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#jsonp">JSONP</a> <cite title="NONE">[jsonp]</cite> by allowing GET requests with an additional parameter: </p>

<dl>
  <dt>callback</dt>
  <dd style="margin-left: 8">OPTIONAL. The qualified name of a JavaScript function.</dd>
</dl>
<p id="rfc.section.2.3.p.3">For example, a client may request the revocation of an access token with the following request (line breaks are for display purposes only):</p>
<pre>  https://example.com/revoke?token=agabcdefddddafdd&amp;
  callback=package.myCallback
</pre>
<p class="figure"></p>
<p id="rfc.section.2.3.p.4">Successful response:</p>
<pre>  package.myCallback();
</pre>
<p class="figure"></p>
<p id="rfc.section.2.3.p.5">Error response:</p>
<pre>  package.myCallback({"error":"unsupported_token_type"});
</pre>
<p class="figure"></p>
<p id="rfc.section.2.3.p.6">Clients should be aware that when relying on JSONP, a malicious revocation end-point may attempt to inject malicious code into the client.</p>
<h1 id="rfc.section.3"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.section.3">3.</a> <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#impl" id="impl">Implementation Note</a></h1>
<p id="rfc.section.3.p.1">OAuth 2.0 allows deployment flexibility with respect to the style of access tokens. The access tokens may be self-contained so that an resource server needs no further interaction with an authorization server issuing these tokens to perform an authorization decision of the client requesting access to a protected resource. A system design may, however, instead use access tokens that are handles referring to authorization data stored at the authorization server. This consequently requires a resource server to issue a request to the respective authorization server to retrieve the content of the access token every time a client presents an access token.</p>
<p id="rfc.section.3.p.2">While these are not the only options they illustrate the implications for revocation. In the latter case the authorization server is able to revoke an access token previously issued to a client when the resource server relays a received access token. In the former case some (currently non-standardized) backend interaction between the authorization server and the resource server may be used when immediate access token revocation is desired. Another design alternative is to issue short-lived access tokens, which can be refreshed at any time using the corresponding refresh tokens. This allows the authorization server to impose a limit on the time revoked access tokens are in use.</p>
<p id="rfc.section.3.p.3">Which approach of token revocation is chosen will depend on the overall system design and on the application service provider's risk analysis. The cost of revocation in terms of required state and communication overhead is ultimately the result of the desired security properties.</p>
<h1 id="rfc.section.4"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.section.4">4.</a> <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#Acknowledgements" id="Acknowledgements">Acknowledgements</a></h1>
<p id="rfc.section.4.p.1">We would like to thank Peter, Mauritius, Amanda Anganes, Mark Wubben, Hannes Tschofenig, Michiel de Jong, Doug Foiles, Paul Madsen, George Fletcher, Sebastian Ebling, Christian Stübner, Brian Campbell, Igor Faynberg, Lukas Rosenstock, and Justin Richer for their valuable feedback.</p>
<h1 id="rfc.section.5"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.section.5">5.</a> <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#IANA" id="IANA">IANA Considerations</a></h1>
<p>
</p><h1 id="rfc.section.5.1"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.section.5.1">5.1.</a> OAuth Extensions Error Registration</h1>
<p id="rfc.section.5.1.p.1">This specification registers the following error values in the OAuth Extensions Error registry defined in <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#RFC6749">[RFC6749]</a>.</p>
<h1 id="rfc.section.5.1.1"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.section.5.1.1">5.1.1.</a> The "unsupported_token_type" Error Value</h1>
<p>

</p><dl>
  <dt>Error name</dt>
  <dd style="margin-left: 8">unsupported_token_type</dd>
  <dt>Error usage location</dt>
  <dd style="margin-left: 8">revocation endpoint error response</dd>
  <dt>Related protocol extension</dt>
  <dd style="margin-left: 8">Token Revocation Endpoint</dd>
  <dt>Change controller</dt>
  <dd style="margin-left: 8">IETF</dd>
  <dt>Specification document(s)</dt>
  <dd style="margin-left: 8">[this document]</dd>
</dl>
<h1 id="rfc.section.6"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.section.6">6.</a> <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#Security" id="Security">Security Considerations</a></h1>
<p id="rfc.section.6.p.1">If the authorization server does not support access token revocation, access tokens will not be immediately invalidated when the corresponding refresh token is revoked. Deployments must take this into account when conducting their security risk analysis.</p>
<p id="rfc.section.6.p.2">Cleaning up tokens using revocation contributes to overall security and privacy since it reduces the likelihood for abuse of abandoned tokens. This specification in general does not intend to provide countermeasures against token theft and abuse. For a discussion of respective threats and countermeasures, consult the security considerations given in section 10 of the OAuth core specification <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#RFC6749">[RFC6749]</a> and the OAuth threat model document <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#RFC6819">[RFC6819]</a>.</p>
<p id="rfc.section.6.p.3">Malicious clients could attempt to use the new endpoint to launch denial of service attacks on the authorization server. Appropriate countermeasures, which should be in place for the token endpoint as well, MUST be applied to the revocation endpoint (see <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#RFC6819">[RFC6819]</a>, section 4.4.1.11).</p>
<p id="rfc.section.6.p.4">A malicious client may attempt to guess valid tokens on this endpoint by making revocation requests against potential token strings. According to this specification, a client's request must contain a valid client_id, in the case of a public client, or valid client credentials, in the case of a confidential client. The token being revoked must also belong to the requesting client. If an attacker is able to successfully guess a public client's client_id and one of their tokens, or a private client's credentials and one of their tokens, they could do much worse damage by using the token elsewhere than by revoking it. If they chose to revoke the token, the legitimate client will lose its authorization grant and will need to prompt the user again. No further damage is done and the guessed token is now worthless.</p>
<p id="rfc.section.6.p.5">Since the revocation endpoint is handling security credentials, clients shall obtain its location from a trustworthy source only. Otherwise, an attacker could capture valid security tokens by utilizing a counterfeit revocation endpoint.</p>
<h1 id="rfc.references"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.references">7.</a> References</h1>
<h1 id="rfc.references.1"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.references.1">7.1.</a> Normative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="RFC2119">[RFC2119]</b>
      </td>
      <td class="top"><a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC2246">[RFC2246]</b>
      </td>
      <td class="top"><a href="mailto:tdierks@certicom.com" title="Certicom">Dierks, T.</a> and <a href="mailto:callen@certicom.com" title="Certicom">C. Allen</a>, "<a href="http://tools.ietf.org/html/rfc2246">The TLS Protocol Version 1.0</a>", RFC 2246, January 1999.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5246">[RFC5246]</b>
      </td>
      <td class="top"><a>Dierks, T.</a> and <a>E. Rescorla</a>, "<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>", RFC 5246, August 2008.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC6749">[RFC6749]</b>
      </td>
      <td class="top"><a>Hardt, D.</a>, "<a href="http://tools.ietf.org/html/rfc6749">The OAuth 2.0 Authorization Framework</a>", RFC 6749, October 2012.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.references.2"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.references.2">7.2.</a> Informative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="W3C.WD-cors-20120403">[W3C.WD-cors-20120403]</b>
      </td>
      <td class="top"><a>Kesteren, A.</a>, "<a>Cross-Origin Resource Sharing</a>", World Wide Web Consortium LastCall WD-cors-20120403, April 2012.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="portable-contacts">[portable-contacts]</b>
      </td>
      <td class="top"><a>Smarr, J.</a>, "<a>Portable Contacts 1.0 Draft C</a>", August 2008.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="jsonp">[jsonp]</b>
      </td>
      <td class="top"><a>Ippolito, B.</a>, "<a>Remote JSON - JSONP</a>", December 2005.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC6819">[RFC6819]</b>
      </td>
      <td class="top"><a>Lodderstedt, T.</a>, <a>McGloin, M.</a> and <a>P. Hunt</a>, "<a href="http://tools.ietf.org/html/rfc6819">OAuth 2.0 Threat Model and Security Considerations</a>", RFC 6819, January 2013.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.authors">
  <a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-7049204489683738429.html#rfc.authors">Authors' Addresses</a>
</h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Torsten Lodderstedt</span> (editor)
	  <span class="n hidden">
		<span class="family-name">Lodderstedt</span>
	  </span>
	</span>
	<span class="org vcardline">Deutsche Telekom AG</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:torsten@lodderstedt.net">torsten@lodderstedt.net</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Stefanie Dronia</span> 
	  <span class="n hidden">
		<span class="family-name">Dronia</span>
	  </span>
	</span>
	<span class="org vcardline"></span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:sdronia@gmx.de">sdronia@gmx.de</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Marius Scurtescu</span> 
	  <span class="n hidden">
		<span class="family-name">Scurtescu </span>
	  </span>
	</span>
	<span class="org vcardline">Google</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:mscurtescu@google.com">mscurtescu@google.com</a></span>

  </address>
</div>



</body></html>