<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML lang=en xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><HEAD 
profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/"><TITLE>OAuth 2.0 Token Revocation</TITLE>
<META content="text/html; charset=windows-1252" http-equiv=Content-Type>
<STYLE title="Xml2Rfc (sans serif)" type=text/css>@page  {}
@page :first {}
A {
	TEXT-DECORATION: none
}
A.smpl {
	COLOR: black
}
A:hover {
	TEXT-DECORATION: underline
}
A:active {
	TEXT-DECORATION: underline
}
ADDRESS {
	FONT-STYLE: normal; MARGIN-TOP: 1em; MARGIN-LEFT: 2em
}
BODY {
	FONT-FAMILY: verdana, helvetica, arial, sans-serif; MAX-WIDTH: 55em; COLOR: black; FONT-SIZE: 10pt
}
CITE {
	FONT-STYLE: normal
}
DD {
	MARGIN-RIGHT: 2em
}
DL {
	MARGIN-LEFT: 2em
}
UL.empty {
	LIST-STYLE-TYPE: none
}
UL.empty LI {
	MARGIN-TOP: 0.5em
}
DL P {
	MARGIN-LEFT: 0em
}
DT {
	MARGIN-TOP: 0.5em
}
H1 {
	PAGE-BREAK-AFTER: avoid; LINE-HEIGHT: 21pt; FONT-SIZE: 14pt
}
H1.np {
	PAGE-BREAK-BEFORE: always
}
H1 A {
	COLOR: #333333
}
H2 {
	PAGE-BREAK-AFTER: avoid; LINE-HEIGHT: 15pt; FONT-SIZE: 12pt
}
H3 {
	PAGE-BREAK-AFTER: avoid; FONT-SIZE: 10pt
}
H4 {
	PAGE-BREAK-AFTER: avoid; FONT-SIZE: 10pt
}
H5 {
	PAGE-BREAK-AFTER: avoid; FONT-SIZE: 10pt
}
H6 {
	PAGE-BREAK-AFTER: avoid; FONT-SIZE: 10pt
}
H2 A {
	COLOR: black
}
H3 A {
	COLOR: black
}
H4 A {
	COLOR: black
}
H5 A {
	COLOR: black
}
H6 A {
	COLOR: black
}
IMG {
	MARGIN-LEFT: 3em
}
LI {
	MARGIN-LEFT: 2em; MARGIN-RIGHT: 2em
}
OL {
	MARGIN-LEFT: 2em; MARGIN-RIGHT: 2em
}
OL P {
	MARGIN-LEFT: 0em
}
P {
	MARGIN-LEFT: 2em; MARGIN-RIGHT: 2em
}
PRE {
	PADDING-BOTTOM: 0.25em; BACKGROUND-COLOR: lightyellow; PADDING-LEFT: 0.25em; PADDING-RIGHT: 0.25em; MARGIN-LEFT: 3em; PADDING-TOP: 0.25em
}
PRE.text2 {
	BORDER-BOTTOM: 1px dotted; BORDER-LEFT: 1px dotted; BACKGROUND-COLOR: #f0f0f0; WIDTH: 69em; BORDER-TOP: 1px dotted; BORDER-RIGHT: 1px dotted
}
PRE.inline {
	PADDING-BOTTOM: 0em; BACKGROUND-COLOR: white; PADDING-LEFT: 0em; PADDING-RIGHT: 0em; PADDING-TOP: 0em
}
PRE.text {
	BORDER-BOTTOM: 1px dotted; BORDER-LEFT: 1px dotted; BACKGROUND-COLOR: #f8f8f8; WIDTH: 69em; BORDER-TOP: 1px dotted; BORDER-RIGHT: 1px dotted
}
PRE.drawing {
	BORDER-BOTTOM: 1px solid; BORDER-LEFT: 1px solid; PADDING-BOTTOM: 2em; BACKGROUND-COLOR: #f8f8f8; PADDING-LEFT: 2em; PADDING-RIGHT: 2em; BORDER-TOP: 1px solid; BORDER-RIGHT: 1px solid; PADDING-TOP: 2em
}
TABLE {
	MARGIN-LEFT: 2em
}
TABLE.tt {
	VERTICAL-ALIGN: top
}
TABLE.full {
	BORDER-BOTTOM: 1px outset; BORDER-LEFT: 1px outset; BORDER-TOP: 1px outset; BORDER-RIGHT: 1px outset
}
TABLE.headers {
	BORDER-BOTTOM: 1px outset; BORDER-LEFT: 1px outset; BORDER-TOP: 1px outset; BORDER-RIGHT: 1px outset
}
TABLE.tt TD {
	VERTICAL-ALIGN: top
}
TABLE.full TD {
	BORDER-BOTTOM: 1px inset; BORDER-LEFT: 1px inset; BORDER-TOP: 1px inset; BORDER-RIGHT: 1px inset
}
TABLE.tt TH {
	VERTICAL-ALIGN: top
}
TABLE.full TH {
	BORDER-BOTTOM: 1px inset; BORDER-LEFT: 1px inset; BORDER-TOP: 1px inset; BORDER-RIGHT: 1px inset
}
TABLE.headers TH {
	BORDER-BOTTOM: 1px inset; BORDER-LEFT: 1px; BORDER-TOP: 1px; BORDER-RIGHT: 1px
}
TABLE.left {
	MARGIN-RIGHT: auto
}
TABLE.right {
	MARGIN-LEFT: auto
}
TABLE.center {
	MARGIN-LEFT: auto; MARGIN-RIGHT: auto
}
CAPTION {
	MARGIN-TOP: 0.5em; CAPTION-SIDE: bottom; FONT-SIZE: 9pt; FONT-WEIGHT: bold
}
TABLE.header {
	BORDER-SPACING: 1px; WIDTH: 95%; COLOR: white; FONT-SIZE: 10pt
}
TD.top {
	VERTICAL-ALIGN: top
}
TD.topnowrap {
	WHITE-SPACE: nowrap; VERTICAL-ALIGN: top
}
TABLE.header TD {
	BACKGROUND-COLOR: gray; WIDTH: 50%
}
TABLE.header A {
	COLOR: white
}
TD.reference {
	PADDING-RIGHT: 1em; WHITE-SPACE: nowrap; VERTICAL-ALIGN: top
}
THEAD {
	DISPLAY: table-header-group
}
UL.toc {
	LIST-STYLE-TYPE: none; PADDING-LEFT: 0em; MARGIN-LEFT: 1.5em; LIST-STYLE-IMAGE: none; MARGIN-RIGHT: 0em
}
UL.toc UL {
	LIST-STYLE-TYPE: none; PADDING-LEFT: 0em; MARGIN-LEFT: 1.5em; LIST-STYLE-IMAGE: none; MARGIN-RIGHT: 0em
}
UL.toc LI {
	LINE-HEIGHT: 150%; MARGIN-LEFT: 0em; FONT-SIZE: 10pt; FONT-WEIGHT: bold; MARGIN-RIGHT: 0em
}
UL.toc LI LI {
	LINE-HEIGHT: normal; MARGIN-LEFT: 0em; FONT-SIZE: 9pt; FONT-WEIGHT: normal; MARGIN-RIGHT: 0em
}
LI.excluded {
	FONT-SIZE: 0pt
}
UL P {
	MARGIN-LEFT: 0em
}
.comment {
	BACKGROUND-COLOR: yellow
}
.center {
	TEXT-ALIGN: center
}
.error {
	FONT-STYLE: italic; COLOR: red; FONT-WEIGHT: bold
}
.figure {
	TEXT-ALIGN: center; FONT-SIZE: 9pt; FONT-WEIGHT: bold
}
.filename {
	TEXT-ALIGN: center; LINE-HEIGHT: 21pt; COLOR: #333333; FONT-SIZE: 12pt; FONT-WEIGHT: bold
}
.fn {
	FONT-WEIGHT: bold
}
.hidden {
	DISPLAY: none
}
.left {
	TEXT-ALIGN: left
}
.right {
	TEXT-ALIGN: right
}
.title {
	TEXT-ALIGN: center; LINE-HEIGHT: 18pt; MARGIN-TOP: 36pt; COLOR: #990000; FONT-SIZE: 18pt; FONT-WEIGHT: bold
}
.vcardline {
	DISPLAY: block
}
.warning {
	BACKGROUND-COLOR: yellow; FONT-SIZE: 14pt
}

@media Print    
{
.noprint {
	DISPLAY: none
}
A {
	COLOR: black; TEXT-DECORATION: none
}
TABLE.header {
	WIDTH: 90%
}
TD.header {
	BACKGROUND-COLOR: white; WIDTH: 50%; COLOR: black; FONT-SIZE: 12pt; VERTICAL-ALIGN: top
}
UL.ind LI LI A {
	
}
.print2col {
	column-count: 2; -moz-column-count: 2; column-fill: auto
}

}
</STYLE>
<LINK rel=Contents href="#rfc.toc"><LINK title="1 Introduction" rel=Chapter 
href="#rfc.section.1"><LINK title="2 Token Revocation" rel=Chapter 
href="#rfc.section.2"><LINK title="2.1 Revocation Request" rel=Chapter 
href="#rfc.section.2.1"><LINK title="2.2 Revocation Response" rel=Chapter 
href="#rfc.section.2.2"><LINK title="2.2.1 Error Response" rel=Chapter 
href="#rfc.section.2.2.1"><LINK title="2.3 Cross-Origin Support" rel=Chapter 
href="#rfc.section.2.3"><LINK title="3 Implementation Note" rel=Chapter 
href="#rfc.section.3"><LINK title="4 IANA Considerations" rel=Chapter 
href="#rfc.section.4"><LINK title="4.1 OAuth Extensions Error Registration" 
rel=Chapter href="#rfc.section.4.1"><LINK 
title='4.1.1 The "unsupported_token_type" Error Value' rel=Chapter 
href="#rfc.section.4.1.1"><LINK title="4.1.2 OAuth Token Type Hint Registry" 
rel=Chapter href="#rfc.section.4.1.2"><LINK 
title="4.1.2.1 Registration Template" rel=Chapter 
href="#rfc.section.4.1.2.1"><LINK title="4.1.2.2 Initial Registry Contents" 
rel=Chapter href="#rfc.section.4.1.2.2"><LINK title="5 Security Considerations" 
rel=Chapter href="#rfc.section.5"><LINK title="6 Acknowledgements" rel=Chapter 
href="#rfc.section.6"><LINK title="7 References" rel=Chapter 
href="#rfc.references"><LINK title="7.1 Normative References" rel=Chapter 
href="#rfc.references.1"><LINK title="7.2 Informative References" rel=Chapter 
href="#rfc.references.2"><LINK rel=Chapter href="#rfc.authors">
<META name=GENERATOR content="MSHTML 8.00.7600.16853"><LINK rel=schema.dct 
href="http://purl.org/dc/terms/">
<META name=dct.creator 
content="Lodderstedt, T., Ed., Dronia, S., and M. Scurtescu ">
<META name=dct.identifier content=urn:ietf:id:draft-ietf-oauth-revocation-09>
<META scheme=ISO8601 name=dct.issued content=2013-5-19>
<META name=dct.abstract 
content="This document proposes an additional endpoint for OAuth authorization servers, which allows clients to notify the authorization server that a previously obtained refresh or access token is no longer needed. This allows the authorization server to cleanup security credentials. A revocation request will invalidate the actual token and, if applicable, other tokens based on the same authorization grant.">
<META name=description 
content="This document proposes an additional endpoint for OAuth authorization servers, which allows clients to notify the authorization server that a previously obtained refresh or access token is no longer needed. This allows the authorization server to cleanup security credentials. A revocation request will invalidate the actual token and, if applicable, other tokens based on the same authorization grant."></HEAD>
<BODY>
<TABLE class=header>
  <TBODY>
  <TR>
    <TD class=left>OAuth Working Group</TD>
    <TD class=right>T. Lodderstedt, Ed.</TD></TR>
  <TR>
    <TD class=left>Internet-Draft</TD>
    <TD class=right>Deutsche Telekom AG</TD></TR>
  <TR>
    <TD class=left>Intended status: Standards Track</TD>
    <TD class=right>S. Dronia</TD></TR>
  <TR>
    <TD class=left>Expires: November 20, 2013</TD>
    <TD class=right>M. Scurtescu</TD></TR>
  <TR>
    <TD class=left></TD>
    <TD class=right>Google</TD></TR>
  <TR>
    <TD class=left></TD>
    <TD class=right>May 19, 2013</TD></TR></TBODY></TABLE>
<P class=title>OAuth 2.0 Token Revocation<BR><SPAN 
class=filename>draft-ietf-oauth-revocation-09</SPAN></P>
<H1 id=rfc.abstract><A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.abstract">Abstract</A> 
</H1>
<P>This document proposes an additional endpoint for OAuth authorization 
servers, which allows clients to notify the authorization server that a 
previously obtained refresh or access token is no longer needed. This allows the 
authorization server to cleanup security credentials. A revocation request will 
invalidate the actual token and, if applicable, other tokens based on the same 
authorization grant.</P>
<H1><A>Requirements Language</A> </H1>
<P>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", 
"SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be 
interpreted as described in <A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#RFC2119">RFC 
2119</A> <CITE title=NONE>[RFC2119]</CITE>.</P>
<H1 id=rfc.status><A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.status">Status 
of This Memo</A> </H1>
<P>This Internet-Draft is submitted in full conformance with the provisions of 
BCP 78 and BCP 79.</P>
<P>Internet-Drafts are working documents of the Internet Engineering Task Force 
(IETF). Note that other groups may also distribute working documents as 
Internet-Drafts. The list of current Internet-Drafts is at 
http://datatracker.ietf.org/drafts/current/.</P>
<P>Internet-Drafts are draft documents valid for a maximum of six months and may 
be updated, replaced, or obsoleted by other documents at any time. It is 
inappropriate to use Internet-Drafts as reference material or to cite them other 
than as "work in progress."</P>
<P>This Internet-Draft will expire on November 20, 2013.</P>
<H1 id=rfc.copyrightnotice><A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.copyrightnotice">Copyright 
Notice</A> </H1>
<P>Copyright (c) 2013 IETF Trust and the persons identified as the document 
authors. All rights reserved.</P>
<P>This document is subject to BCP 78 and the IETF Trust's Legal Provisions 
Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on 
the date of publication of this document. Please review these documents 
carefully, as they describe your rights and restrictions with respect to this 
document. Code Components extracted from this document must include Simplified 
BSD License text as described in Section 4.e of the Trust Legal Provisions and 
are provided without warranty as described in the Simplified BSD License.</P>
<HR class=noprint>

<H1 id=rfc.toc class=np><A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.toc">Table 
of Contents</A></H1>
<UL class=toc>
  <LI>1. <A 
  href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.section.1">Introduction</A></LI>
  <LI>2. <A 
  href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.section.2">Token 
  Revocation</A></LI>
  <LI>2.1. <A 
  href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.section.2.1">Revocation 
  Request</A></LI>
  <LI>2.2. <A 
  href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.section.2.2">Revocation 
  Response</A></LI>
  <LI>2.2.1. <A 
  href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.section.2.2.1">Error 
  Response</A></LI>
  <LI>2.3. <A 
  href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.section.2.3">Cross-Origin 
  Support</A></LI>
  <LI>3. <A 
  href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.section.3">Implementation 
  Note</A></LI>
  <LI>4. <A 
  href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.section.4">IANA 
  Considerations</A></LI>
  <LI>4.1. <A 
  href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.section.4.1">OAuth 
  Extensions Error Registration</A></LI>
  <LI>4.1.1. <A 
  href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.section.4.1.1">The 
  "unsupported_token_type" Error Value</A></LI>
  <LI>4.1.2. <A 
  href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.section.4.1.2">OAuth 
  Token Type Hint Registry</A></LI>
  <LI>4.1.2.1. <A 
  href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.section.4.1.2.1">Registration 
  Template</A></LI>
  <LI>4.1.2.2. <A 
  href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.section.4.1.2.2">Initial 
  Registry Contents</A></LI>
  <LI>5. <A 
  href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.section.5">Security 
  Considerations</A></LI>
  <LI>6. <A 
  href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.section.6">Acknowledgements</A></LI>
  <LI>7. <A 
  href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.references">References</A></LI>
  <LI>7.1. <A 
  href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.references.1">Normative 
  References</A></LI>
  <LI>7.2. <A 
  href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.references.2">Informative 
  References</A></LI>
  <LI><A 
  href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.authors">Authors' 
  Addresses</A></LI></UL>
<H1 id=rfc.section.1><A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.section.1">1.</A> 
<A id=Introduction 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#Introduction">Introduction</A></H1>
<P id=rfc.section.1.p.1>The OAuth 2.0 core specification <A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#RFC6749">[RFC6749]</A> 
defines several ways for a client to obtain refresh and access tokens. This 
specification supplements the core specification with a mechanism to revoke both 
types of tokens. A token is a string representing an authorization grant issued 
by the resource owner to the client. A revocation request will invalidate the 
actual token and, if applicable, other tokens based on the same authorization 
grant and the authorization grant itself.</P>
<P id=rfc.section.1.p.2>From an end-user's perspective, OAuth is often used to 
log into a certain site or application. This revocation mechanism allows a 
client to invalidate its tokens if the end-user logs out, changes identity, or 
uninstalls the respective application. Notifying the authorization server that 
the token is no longer needed allows the authorization server to clean up data 
associated with that token (e.g. session data) and the underlying authorization 
grant. This behavior prevents a situation where there is still a valid 
authorization grant for a particular client which the end user is not aware of. 
This way, token revocation prevents abuse of abandoned tokens and facilitates a 
better end-user experience since invalidated authorization grants will no longer 
turn up in a list of authorization grants the authorization server might present 
to the end-user.</P>
<H1 id=rfc.section.2><A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.section.2">2.</A> 
<A id=Revocation 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#Revocation">Token 
Revocation</A></H1>
<P id=rfc.section.2.p.1>Implementations MUST support the revocation of refresh 
tokens and SHOULD support the revocation of access tokens (see <A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#impl">Implementation 
Note</A>).</P>
<P id=rfc.section.2.p.2>The client requests the revocation of a particular token 
by making an HTTP POST request to the token revocation endpoint URL. This URL 
MAY include a query component. The means to obtain the location of the 
revocation endpoint is out of scope of this specification. For example, the 
client developer may consult the server's documentation or automatic discovery 
may be used. As this endpoint is handling security credentials, the endpoint 
location needs to be obtained from a trustworthy source.</P>
<P id=rfc.section.2.p.3>Since requests to the token revocation endpoint result 
in the transmission of plain text credentials in the HTTP request, the 
authorization server MUST require the use of a transport-layer security 
mechanism when sending requests to the token revocation endpoints. The 
authorization server MUST support TLS 1.0 (<A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#RFC2246">[RFC2246]</A>), 
SHOULD support TLS 1.2 (<A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#RFC5246">[RFC5246]</A>) 
and its future replacements, and MAY support additional transport-layer 
mechanisms meeting its security requirements.</P>
<H1 id=rfc.section.2.1><A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.section.2.1">2.1.</A> 
Revocation Request</H1>
<P id=rfc.section.2.1.p.1>The client constructs the request by including the 
following parameters using the "application/x-www-form-urlencoded" format in the 
HTTP request entity-body:</P>
<P>
<DL>
  <DT>token</DT>
  <DD>REQUIRED. The token that the client wants to get revoked.</DD>
  <DT>token_type_hint</DT>
  <DD>OPTIONAL. A hint about the type of the token submitted for revocation. 
  Clients MAY pass this parameter in order to help the authorization server to 
  optimize the token lookup. If the server is unable to locate the token using 
  the given hint, it MUST extend its search accross all of its supported token 
  types. An authorization server MAY ignore this parameter, particularly if it 
  is able to detect the token type automatically. This specification defines two 
  such values:
  <UL>
    <LI>access_token: An Access Token as defined in <A 
    href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#RFC6749">[RFC6749]</A> 
    section 1.4</LI>
    <LI>refresh_token: A Refresh Token as defined in <A 
    href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#RFC6749">[RFC6749]</A> 
    section 1.5</LI></UL>
  <P>Specific implementations, profiles, and extensions of this specification 
  MAY define other values for this parameter parameter using the registry 
  defined in </P><A 
  href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#hint-reg">Section 
  4.1.2</A>.</DD></DL>
<P id=rfc.section.2.1.p.3>The client also includes its authentication 
credentials as described in Section 2.3. of <A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#RFC6749">[RFC6749]</A>.</P>
<P id=rfc.section.2.1.p.4>For example, a client may request the revocation of a 
refresh token with the following request:</P><PRE>  POST /revoke HTTP/1.1
  Host: server.example.com
  Content-Type: application/x-www-form-urlencoded
  Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
     
  token=45ghiukldjahdnhzdauz&amp;token_type_hint=refresh_token</PRE>
<P class=figure></P>
<P id=rfc.section.2.1.p.5>The authorization server first validates the client 
credentials (in case of a confidential client) and then verifies whether the 
token was issued to the client making the revocation request. If this validation 
fails, the request is refused and the client is informed of the error by the 
authorization server as described below.</P>
<P id=rfc.section.2.1.p.6>In the next step, the authorization server invalidates 
the token. The client MUST assume the revocation is immediate upon the receipt 
of an HTTP 200 response from the server. The client MUST NOT use the token again 
after the revocation.</P>
<P id=rfc.section.2.1.p.7>Depending on the authorization server's revocation 
policy, the revocation of a particular token may cause the revocation of related 
tokens and the underlying authorization grant. If the particular token is a 
refresh token and the authorization server supports the revocation of access 
tokens, then the authorization server SHOULD also invalidate all access tokens 
based on the same authorization grant (see <A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#impl">Implementation 
Note</A>). If the token passed to the request is an access token, the server MAY 
decide to revoke the respective refresh token as well.</P>
<P id=rfc.section.2.1.p.8>Note: A client compliant with <A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#RFC6749">[RFC6749]</A> 
MUST be prepared to handle unexpected token invalidation at any time. 
Independent of the revocation mechanism specified in this document, resource 
owners may decide to revoke authorization grants or the authorization server may 
invalidate tokens in order to mitigate security threats. Thus having different 
server policies with respect to cascading the revocation of tokens should not 
pose interoperability problems.</P>
<H1 id=rfc.section.2.2><A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.section.2.2">2.2.</A> 
Revocation Response</H1>
<P id=rfc.section.2.2.p.1>The authorization server responds with HTTP status 
code 200 if the token has been revoked sucessfully or if the client submitted an 
invalid token. The content of the response body does not matter as all 
information is conveyed in the response code.</P>
<P id=rfc.section.2.2.p.2>An invalid token type hint value is ignored by the 
authorization server and does not influence the revocation response.</P>
<H1 id=rfc.section.2.2.1><A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.section.2.2.1">2.2.1.</A> 
Error Response</H1>
<P id=rfc.section.2.2.1.p.1>The error presentation conforms to the defintion in 
section 5.2 of <A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#RFC6749">[RFC6749]</A>. 
The following additional error code is defined for the token revocation 
endpoint: </P>
<DL>
  <DT>unsupported_token_type</DT>
  <DD>The authorization server does not support the revocation of the presented 
  token type. I.e. the client tried to revoke an access token on a server not 
  supporting this feature.</DD></DL>
<P id=rfc.section.2.2.1.p.2>If the server responds with HTTP status code 503, 
the client must assume the token still exists and may retry after a reasonable 
delay. The server may include a "Retry-After" header in the response to indicate 
how long the service is expected to be unavailable to the requesting client.</P>
<H1 id=rfc.section.2.3><A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.section.2.3">2.3.</A> 
<A id=cross-orgin 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#cross-orgin">Cross-Origin 
Support</A></H1>
<P id=rfc.section.2.3.p.1>The revocation end-point MAY support <A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#W3C.WD-cors-20120403">CORS</A> 
<CITE title=NONE>[W3C.WD-cors-20120403]</CITE> if it is aimed at use in 
combination with user-agent-based applications.</P>
<P id=rfc.section.2.3.p.2>In addition, for interoperability with legacy 
user-agents, it MAY also offer <A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#jsonp">JSONP</A> 
<CITE title=NONE>[jsonp]</CITE> by allowing GET requests with an additional 
parameter: </P>
<DL>
  <DT>callback</DT>
  <DD>OPTIONAL. The qualified name of a JavaScript function.</DD></DL>
<P id=rfc.section.2.3.p.3>For example, a client may request the revocation of an 
access token with the following request (line breaks are for display purposes 
only):</P><PRE>  https://example.com/revoke?token=agabcdefddddafdd&amp;
  callback=package.myCallback
</PRE>
<P class=figure></P>
<P id=rfc.section.2.3.p.4>Successful response:</P><PRE>  package.myCallback();
</PRE>
<P class=figure></P>
<P id=rfc.section.2.3.p.5>Error response:</P><PRE>  package.myCallback({"error":"unsupported_token_type"});
</PRE>
<P class=figure></P>
<P id=rfc.section.2.3.p.6>Clients should be aware that when relying on JSONP, a 
malicious revocation end-point may attempt to inject malicious code into the 
client.</P>
<H1 id=rfc.section.3><A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.section.3">3.</A> 
<A id=impl 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#impl">Implementation 
Note</A></H1>
<P id=rfc.section.3.p.1>OAuth 2.0 allows deployment flexibility with respect to 
the style of access tokens. The access tokens may be self-contained so that an 
resource server needs no further interaction with an authorization server 
issuing these tokens to perform an authorization decision of the client 
requesting access to a protected resource. A system design may, however, instead 
use access tokens that are handles referring to authorization data stored at the 
authorization server. This consequently requires a resource server to issue a 
request to the respective authorization server to retrieve the content of the 
access token every time a client presents an access token.</P>
<P id=rfc.section.3.p.2>While these are not the only options they illustrate the 
implications for revocation. In the latter case the authorization server is able 
to revoke an access token previously issued to a client when the resource server 
relays a received access token. In the former case some (currently 
non-standardized) backend interaction between the authorization server and the 
resource server may be used when immediate access token revocation is desired. 
Another design alternative is to issue short-lived access tokens, which can be 
refreshed at any time using the corresponding refresh tokens. This allows the 
authorization server to impose a limit on the time revoked access tokens are in 
use.</P>
<P id=rfc.section.3.p.3>Which approach of token revocation is chosen will depend 
on the overall system design and on the application service provider's risk 
analysis. The cost of revocation in terms of required state and communication 
overhead is ultimately the result of the desired security properties.</P>
<H1 id=rfc.section.4><A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.section.4">4.</A> 
<A id=IANA 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#IANA">IANA 
Considerations</A></H1>
<P>
<H1 id=rfc.section.4.1><A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.section.4.1">4.1.</A> 
OAuth Extensions Error Registration</H1>
<P id=rfc.section.4.1.p.1>This specification registers the following error 
values in the OAuth Extensions Error registry defined in <A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#RFC6749">[RFC6749]</A>.</P>
<H1 id=rfc.section.4.1.1><A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.section.4.1.1">4.1.1.</A> 
The "unsupported_token_type" Error Value</H1>
<P>
<DL>
  <DT>Error name</DT>
  <DD>unsupported_token_type</DD>
  <DT>Error usage location</DT>
  <DD>revocation endpoint error response</DD>
  <DT>Related protocol extension</DT>
  <DD>Token Revocation Endpoint</DD>
  <DT>Change controller</DT>
  <DD>IETF</DD>
  <DT>Specification document(s)</DT>
  <DD>[this document]</DD></DL>
<H1 id=rfc.section.4.1.2><A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.section.4.1.2">4.1.2.</A> 
<A id=hint-reg 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#hint-reg">OAuth 
Token Type Hint Registry</A></H1>
<P id=rfc.section.4.1.2.p.1>This specification establishes the OAuth Token Type 
Hint registry. Possible values of the parameter "token_type_hint" (see Section 
2.1) are registered with a Specification Required (<A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#RFC5226">[RFC5226]</A>) 
after a two-week review period on the TBD@ietf.org mailing list, on the advice 
of one or more Designated Experts. However, to allow for the allocation of 
values prior to publication, the Designated Expert(s) may approve registration 
once they are satisfied that such a specification will be published. 
Registration requests must be sent to the TBD@ietf.org mailing list for review 
and comment, with an appropriate subject (e.g., "Request for parameter: 
example"). Within the review period, the Designated Expert(s) will either 
approve or deny the registration request, communicating this decision to the 
review list and IANA. Denials should include an explanation and, if applicable, 
suggestions as to how to make the request successful. IANA must only accept 
registry updates from the Designated Expert(s) and should direct all requests 
for registration to the review mailing list.</P>
<H1 id=rfc.section.4.1.2.1><A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.section.4.1.2.1">4.1.2.1.</A> 
Registration Template</H1>
<P>
<DL>
  <DT>Hint Value:</DT>
  <DD>The additional value, which can be used to indicate a certain token type 
  to the authorization server.</DD>
  <DT>Change controller:</DT>
  <DD>For Standards Track RFCs, state "IETF". For others, give the name of the 
  responsible party. Other details (e.g., postal address, email address, home 
  page URI) may also be included.</DD>
  <DT>Specification document(s):</DT>
  <DD>Reference to the document(s) that specify the type, preferably including a 
  URI that can be used to retrieve a copy of the document(s). An indication of 
  the relevant sections may also be included but is not required.</DD></DL>
<H1 id=rfc.section.4.1.2.2><A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.section.4.1.2.2">4.1.2.2.</A> 
Initial Registry Contents</H1>
<P id=rfc.section.4.1.2.2.p.1>The OAuth Token Type Hint registry's initial 
contents are:</P>
<P>
<UL>
  <LI>Hint Value: access_token</LI>
  <LI>Change controller: IETF</LI>
  <LI>Specification document(s): [this document]</LI>
  <LI>Hint Value: refresh_token</LI>
  <LI>Change controller: IETF</LI>
  <LI>Specification document(s): [this document]</LI></UL>
<H1 id=rfc.section.5><A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.section.5">5.</A> 
<A id=Security 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#Security">Security 
Considerations</A></H1>
<P id=rfc.section.5.p.1>If the authorization server does not support access 
token revocation, access tokens will not be immediately invalidated when the 
corresponding refresh token is revoked. Deployments must take this into account 
when conducting their security risk analysis.</P>
<P id=rfc.section.5.p.2>Cleaning up tokens using revocation contributes to 
overall security and privacy since it reduces the likelihood for abuse of 
abandoned tokens. This specification in general does not intend to provide 
countermeasures against token theft and abuse. For a discussion of respective 
threats and countermeasures, consult the security considerations given in 
section 10 of the OAuth core specification <A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#RFC6749">[RFC6749]</A> 
and the OAuth threat model document <A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#RFC6819">[RFC6819]</A>.</P>
<P id=rfc.section.5.p.3>Malicious clients could attempt to use the new endpoint 
to launch denial of service attacks on the authorization server. Appropriate 
countermeasures, which should be in place for the token endpoint as well, MUST 
be applied to the revocation endpoint (see <A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#RFC6819">[RFC6819]</A>, 
section 4.4.1.11). Specifically, invalid token type hints may misguide the 
authorization server and cause additional database lookups. Care MUST be taken 
to prevent malicious clients from exploiting this feature to launch denial of 
service attacks.</P>
<P id=rfc.section.5.p.4>A malicious client may attempt to guess valid tokens on 
this endpoint by making revocation requests against potential token strings. 
According to this specification, a client's request must contain a valid 
client_id, in the case of a public client, or valid client credentials, in the 
case of a confidential client. The token being revoked must also belong to the 
requesting client. If an attacker is able to successfully guess a public 
client's client_id and one of their tokens, or a private client's credentials 
and one of their tokens, they could do much worse damage by using the token 
elsewhere than by revoking it. If they chose to revoke the token, the legitimate 
client will lose its authorization grant and will need to prompt the user again. 
No further damage is done and the guessed token is now worthless.</P>
<P id=rfc.section.5.p.5>Since the revocation endpoint is handling security 
credentials, clients need to obtain its location from a trustworthy source only. 
Otherwise, an attacker could capture valid security tokens by utilizing a 
counterfeit revocation endpoint. Moreover in order to detect counterfeit 
revocation endpoints, clients MUST authenticate the revocation endpoint 
(certificate validation etc.).</P>
<H1 id=rfc.section.6><A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.section.6">6.</A> 
<A id=Acknowledgements 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#Acknowledgements">Acknowledgements</A></H1>
<P id=rfc.section.6.p.1>We would like to thank Peter Mauritius, Amanda Anganes, 
Mark Wubben, Hannes Tschofenig, Michiel de Jong, Doug Foiles, Paul Madsen, 
George Fletcher, Sebastian Ebling, Christian Stübner, Brian Campbell, Igor 
Faynberg, Lukas Rosenstock, and Justin Richer for their valuable feedback.</P>
<H1 id=rfc.references><A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.references">7.</A> 
References</H1>
<H1 id=rfc.references.1><A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.references.1">7.1.</A> 
Normative References</H1>
<TABLE>
  <TBODY>
  <TR>
    <TD class=reference><B id=RFC2119>[RFC2119]</B> </TD>
    <TD class=top><A title="Harvard University" 
      href="mailto:sob@harvard.edu">Bradner, S.</A>, "<A 
      href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to 
      Indicate Requirement Levels</A>", BCP 14, RFC 2119, March 1997.</TD></TR>
  <TR>
    <TD class=reference><B id=RFC2246>[RFC2246]</B> </TD>
    <TD class=top><A title=Certicom href="mailto:tdierks@certicom.com">Dierks, 
      T.</A> and <A title=Certicom href="mailto:callen@certicom.com">C. 
      Allen</A>, "<A href="http://tools.ietf.org/html/rfc2246">The TLS Protocol 
      Version 1.0</A>", RFC 2246, January 1999.</TD></TR>
  <TR>
    <TD class=reference><B id=RFC5226>[RFC5226]</B> </TD>
    <TD class=top><A>Narten, T.</A> and <A>H. Alvestrand</A>, "<A 
      href="http://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA 
      Considerations Section in RFCs</A>", BCP 26, RFC 5226, May 2008.</TD></TR>
  <TR>
    <TD class=reference><B id=RFC5246>[RFC5246]</B> </TD>
    <TD class=top><A>Dierks, T.</A> and <A>E. Rescorla</A>, "<A 
      href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security 
      (TLS) Protocol Version 1.2</A>", RFC 5246, August 2008.</TD></TR>
  <TR>
    <TD class=reference><B id=RFC6749>[RFC6749]</B> </TD>
    <TD class=top><A>Hardt, D.</A>, "<A 
      href="http://tools.ietf.org/html/rfc6749">The OAuth 2.0 Authorization 
      Framework</A>", RFC 6749, October 2012.</TD></TR></TBODY></TABLE>
<H1 id=rfc.references.2><A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.references.2">7.2.</A> 
Informative References</H1>
<TABLE>
  <TBODY>
  <TR>
    <TD class=reference><B id=W3C.WD-cors-20120403>[W3C.WD-cors-20120403]</B> 
    </TD>
    <TD class=top><A>Kesteren, A.</A>, "<A>Cross-Origin Resource Sharing</A>", 
      World Wide Web Consortium LastCall WD-cors-20120403, April 2012.</TD></TR>
  <TR>
    <TD class=reference><B id=jsonp>[jsonp]</B> </TD>
    <TD class=top><A>Ippolito, B.</A>, "<A>Remote JSON - JSONP</A>", December 
      2005.</TD></TR>
  <TR>
    <TD class=reference><B id=RFC6819>[RFC6819]</B> </TD>
    <TD class=top><A>Lodderstedt, T.</A>, <A>McGloin, M.</A> and <A>P. 
      Hunt</A>, "<A href="http://tools.ietf.org/html/rfc6819">OAuth 2.0 Threat 
      Model and Security Considerations</A>", RFC 6819, January 
  2013.</TD></TR></TBODY></TABLE>
<H1 id=rfc.authors><A 
href="file:///C:/Users/t.lodderstedt/AppData/Local/Temp/xml2rfc-xxe-8373423764184104164.html#rfc.authors">Authors' 
Addresses</A> </H1>
<DIV class=avoidbreak>
<ADDRESS class=vcard><SPAN class=vcardline><SPAN class=fn>Torsten 
Lodderstedt</SPAN> (editor) <SPAN class="n hidden"><SPAN 
class=family-name>Lodderstedt</SPAN> </SPAN></SPAN><SPAN 
class="org vcardline">Deutsche Telekom AG</SPAN> <SPAN class=adr><SPAN 
class=vcardline><SPAN class=locality></SPAN><SPAN class=region></SPAN><SPAN 
class=code></SPAN></SPAN><SPAN 
class="country-name vcardline"></SPAN></SPAN><SPAN class=vcardline>EMail: <A 
href="mailto:torsten@lodderstedt.net">torsten@lodderstedt.net</A></SPAN> 
</ADDRESS></DIV>
<DIV class=avoidbreak>
<ADDRESS class=vcard><SPAN class=vcardline><SPAN class=fn>Stefanie Dronia</SPAN> 
<SPAN class="n hidden"><SPAN class=family-name>Dronia</SPAN> </SPAN></SPAN><SPAN 
class="org vcardline"></SPAN><SPAN class=adr><SPAN class=vcardline><SPAN 
class=locality></SPAN><SPAN class=region></SPAN><SPAN 
class=code></SPAN></SPAN><SPAN 
class="country-name vcardline"></SPAN></SPAN><SPAN class=vcardline>EMail: <A 
href="mailto:sdronia@gmx.de">sdronia@gmx.de</A></SPAN> </ADDRESS></DIV>
<DIV class=avoidbreak>
<ADDRESS class=vcard><SPAN class=vcardline><SPAN class=fn>Marius 
Scurtescu</SPAN> <SPAN class="n hidden"><SPAN class=family-name>Scurtescu 
</SPAN></SPAN></SPAN><SPAN class="org vcardline">Google</SPAN> <SPAN 
class=adr><SPAN class=vcardline><SPAN class=locality></SPAN><SPAN 
class=region></SPAN><SPAN class=code></SPAN></SPAN><SPAN 
class="country-name vcardline"></SPAN></SPAN><SPAN class=vcardline>EMail: <A 
href="mailto:mscurtescu@google.com">mscurtescu@google.com</A></SPAN> 
</ADDRESS></DIV></BODY></HTML>
