<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- saved from url=(0077)file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>OAuth 2.0 Threat Model and Security Considerations</title>

<meta name="description" content="OAuth 2.0 Threat Model and Security Considerations">
<meta name="keywords" content="security, oauth 2.0, threat model">
<meta name="generator" content="xml2rfc v1.36 (http://xml.resource.org/)">
<style type="text/css"><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: small; color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: small; font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: small; font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: small; text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tbody><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tbody><tr><td class="header">Web Authorization Protocol (oauth)</td><td class="header">T. Lodderstedt, Ed.</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Deutsche Telekom AG</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">M. McGloin</td></tr>
<tr><td class="header">Expires: August 22, 2012</td><td class="header">IBM</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">P. Hunt</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Oracle Corporation</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">February 19, 2012</td></tr>
</tbody></table></td></tr></tbody></table>
<h1><br>OAuth 2.0 Threat Model and Security Considerations<br>draft-ietf-oauth-v2-threatmodel-02</h1>

<h3>Abstract</h3>

<p>This document gives security considerations based on a comprehensive threat model for the OAuth 2.0 Protocol.
</p>
<h3>Requirements Language</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#RFC2119">RFC 2119<span> (</span><span class="info">Bradner, S., “Key words for use in RFCs to Indicate Requirement Levels,” March&nbsp;1997.</span><span>)</span></a> [RFC2119].
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as “work in progress.”</p>
<p>
This Internet-Draft will expire on August 22, 2012.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2012 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br><hr>
<h3>Table of Contents</h3>
<p class="toc">
<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor1">1.</a>&nbsp;
Introduction<br>
<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor2">2.</a>&nbsp;
Overview<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor3">2.1.</a>&nbsp;
Scope<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor4">2.2.</a>&nbsp;
Attack Assumptions<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor5">2.3.</a>&nbsp;
Architectural assumptions<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor6">2.3.1.</a>&nbsp;
Authorization Servers<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor7">2.3.2.</a>&nbsp;
Resource Server<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor8">2.3.3.</a>&nbsp;
Client<br>
<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor9">3.</a>&nbsp;
Security Features<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor10">3.1.</a>&nbsp;
Tokens<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor11">3.1.1.</a>&nbsp;
Scope<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor12">3.1.2.</a>&nbsp;
Expires_In<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor13">3.2.</a>&nbsp;
Access Token<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor14">3.3.</a>&nbsp;
Refresh Token<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor15">3.4.</a>&nbsp;
Authorization Code<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor16">3.5.</a>&nbsp;
Redirection URI<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor17">3.6.</a>&nbsp;
State parameter<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor18">3.7.</a>&nbsp;
Client Identity<br>
<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor19">4.</a>&nbsp;
Security Threat Model<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor20">4.1.</a>&nbsp;
Clients<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#ObtainClientSecrets">4.1.1.</a>&nbsp;
Threat: Obtain Client Secrets<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor21">4.1.2.</a>&nbsp;
Threat: Obtain Refresh Tokens<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor22">4.1.3.</a>&nbsp;
Threat: Obtain Access Tokens<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor23">4.1.4.</a>&nbsp;
Threat: End-user credentials phished using compromised or embedded browser<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#open_redirector_client">4.1.5.</a>&nbsp;
Threat: Open Redirectors on client<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor24">4.2.</a>&nbsp;
Authorization Endpoint<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor25">4.2.1.</a>&nbsp;
Threat: Password phishing by counterfeit authorization server<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor26">4.2.2.</a>&nbsp;
Threat: User unintentionally grants too much access scope<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#mal_client3">4.2.3.</a>&nbsp;
Threat: Malicious client obtains existing authorization by fraud<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#open_redirector">4.2.4.</a>&nbsp;
Threat: Open redirector<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor27">4.3.</a>&nbsp;
Token endpoint<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor28">4.3.1.</a>&nbsp;
Threat: Eavesdropping access tokens<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor29">4.3.2.</a>&nbsp;
Threat: Obtain access tokens from authorization server database<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor30">4.3.3.</a>&nbsp;
Threat: Obtain client credentials over non secure transport<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor31">4.3.4.</a>&nbsp;
Threat: Obtain client secret from authorization server database<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor32">4.3.5.</a>&nbsp;
Threat: Obtain client secret by online guessing<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor33">4.3.6.</a>&nbsp;
Threat: DoS on dynamic client secret creation<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor34">4.4.</a>&nbsp;
Obtaining Authorization<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#code_flow">4.4.1.</a>&nbsp;
Authorization Code<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#eavesdropping">4.4.1.1.</a>&nbsp;
Threat: Eavesdropping or leaking authorization codes<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor35">4.4.1.2.</a>&nbsp;
Threat: Obtain authorization codes from authorization server database<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor36">4.4.1.3.</a>&nbsp;
Threat: Online guessing of authorization codes<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#mal_client">4.4.1.4.</a>&nbsp;
Threat: Malicious client obtains authorization<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor37">4.4.1.5.</a>&nbsp;
Threat: Authorization code phishing<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor38">4.4.1.6.</a>&nbsp;
Threat: User session impersonation<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#authz_code_leakage">4.4.1.7.</a>&nbsp;
Threat: Authorization code leakage through counterfeit client<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor39">4.4.1.8.</a>&nbsp;
Threat: CSRF attack against redirect-uri<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor40">4.4.1.9.</a>&nbsp;
Threat: Clickjacking attack against authorization<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor41">4.4.1.10.</a>&nbsp;
Threat: Resource Owner Impersonation<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor42">4.4.1.11.</a>&nbsp;
Threat: DoS, Exhaustion of resources attacks<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#semi">4.4.1.12.</a>&nbsp;
Threat: DoS using manufactured authorization codes<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#implicite_flow">4.4.2.</a>&nbsp;
Implicit Grant<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor43">4.4.2.1.</a>&nbsp;
Threat: Access token leak in transport/end-points<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor44">4.4.2.2.</a>&nbsp;
Threat: Access token leak in browser history<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#mal_client2">4.4.2.3.</a>&nbsp;
Threat: Malicious client obtains authorization<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor45">4.4.2.4.</a>&nbsp;
Threat: Manipulation of scripts<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor46">4.4.2.5.</a>&nbsp;
Threat: CSRF attack against redirect-uri<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#pwd_flow">4.4.3.</a>&nbsp;
Resource Owner Password Credentials<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor47">4.4.3.1.</a>&nbsp;
Threat: Accidental exposure of passwords at client site<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor48">4.4.3.2.</a>&nbsp;
Threat: Client obtains scopes without end-user authorization<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor49">4.4.3.3.</a>&nbsp;
Threat: Client obtains refresh token through automatic authorization<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor50">4.4.3.4.</a>&nbsp;
Threat: Obtain user passwords on transport<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor51">4.4.3.5.</a>&nbsp;
Threat: Obtain user passwords from authorization server database<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor52">4.4.3.6.</a>&nbsp;
Threat: Online guessing<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor53">4.4.4.</a>&nbsp;
Client Credentials<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor54">4.5.</a>&nbsp;
Refreshing an Access Token<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor55">4.5.1.</a>&nbsp;
Threat: Eavesdropping refresh tokens from authorization server<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor56">4.5.2.</a>&nbsp;
Threat: Obtaining refresh token from authorization server database<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor57">4.5.3.</a>&nbsp;
Threat: Obtain refresh token by online guessing<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor58">4.5.4.</a>&nbsp;
Threat: Obtain refresh token phishing by counterfeit authorization server<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor59">4.6.</a>&nbsp;
Accessing Protected Resources<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor60">4.6.1.</a>&nbsp;
Threat: Eavesdropping access tokens on transport<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor61">4.6.2.</a>&nbsp;
Threat: Replay authorized resource server requests<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor62">4.6.3.</a>&nbsp;
Threat: Guessing access tokens<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor63">4.6.4.</a>&nbsp;
Threat: Access token phishing by counterfeit resource server<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor64">4.6.5.</a>&nbsp;
Threat: Abuse of token by legitimate resource server or client<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor65">4.6.6.</a>&nbsp;
Threat: Leak of confidential data in HTTP-Proxies<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor66">4.6.7.</a>&nbsp;
Threat: Token leakage via logfiles and HTTP referrers<br>
<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#security_considerations">5.</a>&nbsp;
Security Considerations<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor67">5.1.</a>&nbsp;
General<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#conf_requests">5.1.1.</a>&nbsp;
Confidentiality of Requests<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#server_authn">5.1.2.</a>&nbsp;
Server authentication<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#informed">5.1.3.</a>&nbsp;
Always keep the resource owner informed<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor68">5.1.4.</a>&nbsp;
Credentials<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#cred_storage_prot">5.1.4.1.</a>&nbsp;
Credential Storage Protection<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#online_secrets">5.1.4.2.</a>&nbsp;
Online attacks on secrets<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor71">5.1.5.</a>&nbsp;
Tokens (access, refresh, code)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#limit_scope">5.1.5.1.</a>&nbsp;
Limit token scope<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#exp_time">5.1.5.2.</a>&nbsp;
Expiration time<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#short_exp_time">5.1.5.3.</a>&nbsp;
Short expiration time<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#one_time_usage">5.1.5.4.</a>&nbsp;
Limit number of usages/ One time usage<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#bind_token_rs">5.1.5.5.</a>&nbsp;
Bind tokens to a particular resource server (Audience)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#endpoint_audience">5.1.5.6.</a>&nbsp;
Use endpoint address as token audience<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#audience_token_scope">5.1.5.7.</a>&nbsp;
Audience and Token scopes<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#bind_token_client_id">5.1.5.8.</a>&nbsp;
Bind token to client id<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#signed_tokens">5.1.5.9.</a>&nbsp;
Signed tokens<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#enc_token">5.1.5.10.</a>&nbsp;
Encryption of token content<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#random_entropy">5.1.5.11.</a>&nbsp;
Random token value with high entropy<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor72">5.1.5.12.</a>&nbsp;
Assertion formats<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#access_tokens">5.1.6.</a>&nbsp;
Access tokens<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor73">5.2.</a>&nbsp;
Authorization Server<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor74">5.2.1.</a>&nbsp;
Authorization Codes<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#automatic_code_revocation">5.2.1.1.</a>&nbsp;
Automatic revocation of derived tokens if abuse is detected<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#refresh_tokens">5.2.2.</a>&nbsp;
Refresh tokens<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#restricted_refresh">5.2.2.1.</a>&nbsp;
Restricted issuance of refresh tokens<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#binding_refresh_client_id">5.2.2.2.</a>&nbsp;
Binding of refresh token to client_id<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#refresh_replace">5.2.2.3.</a>&nbsp;
Refresh Token Rotation<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#refresh_revocation">5.2.2.4.</a>&nbsp;
Refresh Token Revocation<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#device_id">5.2.2.5.</a>&nbsp;
Device identification<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#clickjacking_xframe">5.2.2.6.</a>&nbsp;
X-FRAME-OPTION header<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#client_aa">5.2.3.</a>&nbsp;
Client authentication and authorization<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#dont_issue">5.2.3.1.</a>&nbsp;
Don't issue secrets to public clients or clients with inappropriate security policy<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#forced_user_consent">5.2.3.2.</a>&nbsp;
Public clients without secret require user consent<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#client_id_redirect">5.2.3.3.</a>&nbsp;
Client_id only in combination with redirect_uri<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#depl_specific_secretes">5.2.3.4.</a>&nbsp;
Deployment-specific client secrets<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#val_redirect">5.2.3.5.</a>&nbsp;
Validation of pre-registered redirect_uri<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#client_secret_revocation">5.2.3.6.</a>&nbsp;
Client secret revocation<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#strong_client_authn">5.2.3.7.</a>&nbsp;
Use strong client authentication (e.g. client_assertion / client_token)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor75">5.2.4.</a>&nbsp;
End-user authorization<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#automatic_processing">5.2.4.1.</a>&nbsp;
Automatic processing of repeated authorizations requires client validation<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#informed_decisions">5.2.4.2.</a>&nbsp;
Informed decisions based on transparency<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#validation_end_user">5.2.4.3.</a>&nbsp;
Validation of client properties by end-user<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#bind_code_client_id">5.2.4.4.</a>&nbsp;
Binding of authorization code to client_id<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#bind_code_redirect">5.2.4.5.</a>&nbsp;
Binding of authorization code to redirect_uri<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor76">5.3.</a>&nbsp;
Client App Security<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#cred_software">5.3.1.</a>&nbsp;
Don't store credentials in code or resources bundled with software packages<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#std_web">5.3.2.</a>&nbsp;
Standard web server protection measures (for config files and databases)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#secure_storage">5.3.3.</a>&nbsp;
Store secrets in a secure storage<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#device_lock">5.3.4.</a>&nbsp;
Utilize device lock to prevent unauthorized device access<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor77">5.3.5.</a>&nbsp;
Platform security measures<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#link_state_uasession">5.3.6.</a>&nbsp;
Link state parameter to user agent session<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor78">5.4.</a>&nbsp;
Resource Servers<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#authz_header">5.4.1.</a>&nbsp;
Authorization headers<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#authn_requests">5.4.2.</a>&nbsp;
Authenticated requests<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#signed_requests">5.4.3.</a>&nbsp;
Signed requests<br>
<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#IANA">6.</a>&nbsp;
IANA Considerations<br>
<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#Acknowledgements">7.</a>&nbsp;
Acknowledgements<br>
<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#rfc.references1">8.</a>&nbsp;
References<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#rfc.references1">8.1.</a>&nbsp;
Normative References<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#rfc.references2">8.2.</a>&nbsp;
Informative References<br>
<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#anchor81">Appendix&nbsp;A.</a>&nbsp;
Document History<br>
<a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#rfc.authors">§</a>&nbsp;
Authors' Addresses<br>
</p>
<br clear="all">

<a name="anchor1"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>This document gives security considerations based on a comprehensive threat model for the OAuth 2.0 Protocol <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#I-D.ietf-oauth-v2">[I‑D.ietf‑oauth‑v2]<span> (</span><span class="info">Hammer, E., Recordon, D., and D. Hardt, “The OAuth 2.0 Authorization Protocol,” January&nbsp;2012.</span><span>)</span></a>. It contains the following content:</p>
<ul class="text">
<li>Documents any assumptions and scope considered when creating the threat model.
</li>
<li>Describes the security features in-built into the OAuth protocol and how they are intended to thwart attacks.
</li>
<li>Gives a comprehensive threat model for OAuth and describes the respective counter measures to thwart those threats.
</li>
</ul><p>Threats include any intentional attacks on OAuth tokens and resources protected by OAuth tokens as well as security risks introduced if the proper security measures are not put in place. Threats are structured along the lines of the protocol structure to aid development teams implement each part of the protocol securely. For example all threats for granting access or all threats for a particular grant type or all threats for protecting the resource server.
</p>
<a name="anchor2"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Overview</h3>

<p>
</p>
<a name="anchor3"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Scope</h3>

<p>The security considerations document only considers clients bound to a particular deployment as supported by <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#I-D.ietf-oauth-v2">[I‑D.ietf‑oauth‑v2]<span> (</span><span class="info">Hammer, E., Recordon, D., and D. Hardt, “The OAuth 2.0 Authorization Protocol,” January&nbsp;2012.</span><span>)</span></a>. Such deployments have the following characteristics:
</p>
<p></p>
<ul class="text">
<li>Resource server URLs are static and well-known at development time, authorization server URLs can be static or discovered.
</li>
<li>Token scope values (e.g. applicable URLs and methods) are well-known at development time.
</li>
<li>Client registration: Since registration of clients is out of scope of the current core spec, this document assumes a broad variety of options from static registration during development time to dynamic registration at runtime.
</li>
</ul><p>The following are considered out of scope :
</p>
<p></p>
<ul class="text">
<li>Communication between authorization server and resource server
</li>
<li>Token formats
</li>
<li>Except for „Resource Owner Password Credentials“ (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#I-D.ietf-oauth-v2">[I‑D.ietf‑oauth‑v2]<span> (</span><span class="info">Hammer, E., Recordon, D., and D. Hardt, “The OAuth 2.0 Authorization Protocol,” January&nbsp;2012.</span><span>)</span></a>, section 4.3), the mechanism used by authorization servers to authenticate the user
</li>
<li>Mechanism by which a user obtained an assertion and any resulting attacks mounted as a result of the assertion being false.
</li>
<li>Clients not bound to a specific deployment: An example could be a mail client with support for contact list access via the portable contacts API (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#portable-contacts">[portable‑contacts]<span> (</span><span class="info">Smarr, J., “Portable Contacts 1.0 Draft C,” August&nbsp;2008.</span><span>)</span></a>). Such clients cannot be registered upfront with a particular deployment and should dynamically discover the URLs relevant for the OAuth protocol.
</li>
</ul>

<a name="anchor4"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Attack Assumptions</h3>

<p>The following assumptions relate to an attacker and resources available to an attacker:
</p>
<p></p>
<ul class="text">
<li>It is assumed the attacker has full access to the network between the client and authorization servers and the client and the resource server, respectively. The attacker may eavesdrop on any communications between those parties. He is not assumed to have access to communication between authorization and resource server.
</li>
<li>It is assumed an attacker has unlimited resources to mount an attack.
</li>
<li>It is assumed that 2 of the 3 parties involved in the OAuth protocol may collude to mount an attack against the 3rd party. For example, the client and authorization server may be under control of an attacker and collude to trick a user to gain access to resources.
</li>
</ul>

<a name="anchor5"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Architectural assumptions</h3>

<p>This section documents the assumptions about the features, limitations, and design options of the different entities of a OAuth deployment along with the security-sensitive data-elements managed by those entity. These assumptions are the foundation of the threat analysis.
</p>
<p>The OAuth protocol leaves deployments with a certain degree of freedom how to implement and apply the standard. The core specification defines the core concepts of an authorization server and a resource server. Both servers can be implemented in the same server entity, or they may also be different entities. The later is typically the case for multi-service providers with a single authentication and authorization system, and are more typical in middleware architectures.
</p>
<a name="anchor6"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.2.3.1"></a><h3>2.3.1.&nbsp;
Authorization Servers</h3>

<p>The following data elements are stored or accessible on the authorization server:
</p>
<p></p>
<ul class="text">
<li>user names and passwords
</li>
<li>client ids and secrets
</li>
<li>client-specific refresh tokens
</li>
<li>client-specific access tokens (in case of handle-based design)
</li>
<li>HTTPS certificate/key
</li>
<li>per-authorization process (in case of handle-based design): redirect_uri, client_id, authorization code
</li>
</ul>

<a name="anchor7"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.2.3.2"></a><h3>2.3.2.&nbsp;
Resource Server</h3>

<p>The following data elements are stored or accessible on the resource server:
</p>
<p></p>
<ul class="text">
<li>user data (out of scope)
</li>
<li>HTTPS certificate/key
</li>
<li>authorization server credentials (handle-based design), or
</li>
<li>authorization server shared secret/public key (assertion-based design)
</li>
<li>access tokens (per request)
</li>
</ul><p> It is assumed that a resource server has no knowledge of refresh tokens, user passwords, or client secrets.
</p>
<a name="anchor8"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.2.3.3"></a><h3>2.3.3.&nbsp;
Client</h3>

<p>A full definition of different client types and profiles is given in <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#I-D.ietf-oauth-v2">[I‑D.ietf‑oauth‑v2]<span> (</span><span class="info">Hammer, E., Recordon, D., and D. Hardt, “The OAuth 2.0 Authorization Protocol,” January&nbsp;2012.</span><span>)</span></a>, Section 2.1.
</p>
<p>The following data elements are stored or accessible on the client:
</p>
<p></p>
<ul class="text">
<li>client id (and client secret or corresponding client credential)
</li>
<li>one or more refresh tokens (persistent) and access tokens (transient) per end-user or other security-context or delegation context
</li>
<li>trusted CA certificates (HTTPS)
</li>
<li>per-authorization process: redirect_uri, authorization code
</li>
</ul>

<a name="anchor9"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Security Features</h3>

<p>These are some of the security features which have been built into the OAuth 2.0 protocol to mitigate attacks and security issues.
</p>
<a name="anchor10"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Tokens</h3>

<p>OAuth makes extensive use many kinds of tokens (access tokens, refresh tokens, authorization codes). The information content of a token can be represented in two ways as follows:
</p>
<p></p>
<blockquote class="text"><dl>
<dt>Handle (or artifact)</dt>
<dd>a reference to some internal data structure within the authorization server; the internal data structure contains the attributes of the token, such as user id, scope, etc. Handles enable simple revocation and do not require cryptographic mechanisms to protect token content from being modified. On the other hand, handles require communication between issuing and consuming entity (e.g. authorization and resource server) in order to validate the token and obtain token-bound data. This communication might have an negative impact on performance and scalability if both entities reside on different systems. Handles are therefore typically used if the issuing and consuming entity are the same. A 'handle' token is often referred to as an 'opaque' token because the resource server does not need to be able to interpret the token directly, it simply uses the token.
</dd>
<dt>Assertions (aka self-contained token)</dt>
<dd>a parseable token. An assertion typically has a duration, an audience, and is digitally signed containing information about the user and the client. Examples of assertion formats are SAML assertions and Kerberos tickets. Assertions can typically directly be validated and used by a resource server without interactions with the authorization server. This results in better performance and scalability in deployment where issuing and consuming entity reside on different systems. Implementing token revocation is more difficult with assertions than with handles.
</dd>
</dl></blockquote><p>Tokens can be used in two ways to invoke requests on resource servers as follows:
</p>
<p></p>
<blockquote class="text"><dl>
<dt>bearer token</dt>
<dd>A 'bearer token' is a token that can be used by any client who has received the token (e.g. <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#I-D.ietf-oauth-v2-bearer">[I‑D.ietf‑oauth‑v2‑bearer]<span> (</span><span class="info">Jones, M., Hardt, D., and D. Recordon, “The OAuth 2.0 Authorization Protocol: Bearer Tokens,” February&nbsp;2012.</span><span>)</span></a>). Because mere possession is enough to use the token it is important that communication between end-points be secured to ensure that only authorized end-points may capture the token. The bearer token is convenient to client applications as it does not require them to do anything to use them (such as a proof of identity). Bearer tokens have similar characteristics to web single-sign-on (SSO) cookies used in browsers.
</dd>
<dt>proof token</dt>
<dd>A 'proof token' is a token that can only be used by a specific client. Each use of the token, requires the client to perform some action that proves that it is the authorized user of the token. Examples of this are MAC tokens, which require the client to digitally sign the resource request with a secret corresponding to the particular token send with the request (e.g.<a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#I-D.ietf-oauth-v2-http-mac">[I‑D.ietf‑oauth‑v2‑http‑mac]<span> (</span><span class="info">Hammer-Lahav, E., “HTTP Authentication: MAC Access Authentication,” February&nbsp;2012.</span><span>)</span></a>).
</dd>
</dl></blockquote>

<a name="anchor11"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.3.1.1"></a><h3>3.1.1.&nbsp;
Scope</h3>

<p>A Scope represents the access authorization associated with a particular token with respect to resource servers, resources and methods on those resources. Scopes are the OAuth way to explicitly manage the power associated with an access token. A scope can be controlled by the authorization server and/or the end-user in order to limit access to resources for OAuth clients these parties deem less secure or trustworthy. Optionally, the client can request the scope to apply to the token but only for lesser scope than would otherwise be granted, e.g. to reduce the potential impact if this token is sent over non secure channels. A scope is typically complemented by a restriction on a token's lifetime.
</p>
<a name="anchor12"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.3.1.2"></a><h3>3.1.2.&nbsp;
Expires_In</h3>

<p>Expires_In allows an authorization server (based on its policies or on behalf of the end-user) to limit the lifetime of the access token. This mechanisms can be used to issue short-living tokens to OAuth clients the authorization server deems less secure or where sending tokens over non secure channels.
</p>
<a name="anchor13"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Access Token</h3>

<p>An access token is used by a client to access a resource. Access tokens typically have short life-spans (minutes or hours) that cover typical session lifetimes. An access token may be refreshed through the use of a refresh token. The short lifespan of an access token in combination with the usage of refresh tokens enables the possibility of passive revocation of access authorization on the expiry of the current access token.
</p>
<a name="anchor14"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Refresh Token</h3>

<p>A refresh token represents a long-lasting authorization of a certain client to access resources on behalf of a resource owner. Such tokens are exchanged between client and authorization server, only. Clients use this kind of token to obtain ("refresh") new access tokens used for resource server invocations.
</p>
<p>A refresh token, coupled with a short access token lifetime, can be used to grant longer access to resources without involving end user authorization. This offers an advantage where resource servers and authorization servers are not the same entity, e.g. in a distributed environment, as the refresh token is always exchanged at the authorization server. The authorization server can revoke the refresh token at any time causing the granted access to be revoked once the current access token expires. Because of this, a short access token lifetime is important if timely revocation is a high priority.
</p>
<p>The refresh token is also a secret bound to the client identifier and client instance which originally requested the authorization and representing the original resource owner grant. This is ensured by the authorization process as follows:
</p>
<p></p>
<ol class="text">
<li>The resource owner and user-agent safely deliver the authorization code to the client instance in first place.
</li>
<li>The client uses it immediately in secure transport-level communications to the authorization server and then securely stores the long-lived refresh token.
</li>
<li>The client always uses the refresh token in secure transport-level communications to the authorization server to get an access token (and optionally rollover the refresh token).
</li>
</ol><p>So as long as the confidentiality of the particular token can be ensured by the client, a refresh tokens can also be used as an alternative mean to authenticate the client instance itself.
</p>
<a name="anchor15"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Authorization Code</h3>

<p>An Authorization Code represents the intermediate result of a successful end-user authorization process and is used by the client to obtain access and refresh token. Authorization codes are sent to the client's redirection URI instead of tokens for two purposes.
</p>
<p></p>
<ol class="text">
<li>Instead of (longer-lasting) tokens, the short-lived authorization code is exposed to potential attackers via URI query parameters (HTTP referrer), browser cache, or log file entries.
</li>
<li>It is much simpler to authenticate clients during the direct request between client and authorization server than in the context of the indirect authorization request. The later would require digital signatures.
</li>
</ol>

<a name="anchor16"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.3.5"></a><h3>3.5.&nbsp;
Redirection URI</h3>

<p>A redirection URI helps to detect malicious clients and prevents phishing attacks from clients attempting to trick the user into believing the phisher is the client. The value of the actual redirection URI used in the authorization request has to be presented and is verified when an authorization code is exchanged for tokens. This helps to prevent attacks, where the authorization code is revealed through redirectors and counterfeit web application clients. The authorization server should require public clients and confidential clients using implicit grant type to pre-register their redirect URIs and validate against the registered redirection URI in the authorization request.
</p>
<a name="anchor17"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.3.6"></a><h3>3.6.&nbsp;
State parameter</h3>

<p>The state parameter is used to link requests and callbacks to prevent CSRF attacks where an attacker authorizes access to his own resources and then tricks a users into following a redirect with the attacker's token. This parameter should bind to the authenticated state in a user agent and, as per the core OAuth spec, the user agent must be capable of keeping it in a location accessible only by the client and user agent, i.e. protected by same-origin policy
</p>
<a name="anchor18"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.3.7"></a><h3>3.7.&nbsp;
Client Identity</h3>

<p>Authentication protocols have typically not taken into account the identity of the software component acting on behalf of the end-user. OAuth does this in order to increase the security level in delegated authorization scenarios and because the client will be able to act without the user being present.
</p>
<p>OAuth uses the client identifier to collate associated request to the same originator, such as
</p>
<p></p>
<ul class="text">
<li>a particular end-user authorization process and the corresponding request on the token's endpoint to exchange the authorization code for tokens or
</li>
<li>the initial authorization and issuance of a token by an end-user to a particular client, and subsequent requests by this client to obtain tokens without user consent (automatic processing of repeated authorization)
</li>
</ul><p>The client identity may also be used by the authorization server to display relevant registration information to a user when requesting consent for scope requested by a particular client. The client identity may be used to limit the number of request for a particular client or to charge the client per request. Client Identity may furthermore be useful to differentiate access by different clients, e.g. in server log files.
</p>
<p>OAuth defines two client types, confidential and public, based on their ability to authenticate with the authorization server (i.e. ability to maintain the confidentiality of their client credentials). Confidential clients are capable of maintaining the confidentiality of client credentials (i.e. a client secret associated with the client identifier) or capable of secure client authentication using other means, such as a client assertion (e.g. SAML) or key cryptography. The latter is considered more secure.
</p>
<p>The authorization server should determine whether the client is capable of keeping its secret confidential or using secure authentication. Alternatively, the end-user can verify the identity of the client, e.g. by only installing trusted applications.The redicrection URI can be used to prevent delivering credentials to a counterfeit client after obtaining end-user authorization in some cases, but can't be used to verify the client identity.
</p>
<p>Clients can be categorized as follows based on the client type, profile (e.g. native vs web application) and deployment model:
</p>
<p></p>
<blockquote class="text"><dl>
<dt>Deployment-independent client_id with pre-registered redirect_uri and without client_secret</dt>
<dd>Such an identity is used by multiple installations of the same software package. The identity of such a client can only be validated with the help of the end-user. This is a viable option for native applications in order to identify the client for the purpose of displaying meta information about the client to the user and to differentiate clients in log files. Revocation of such an identity will affect ALL deployments of the respective software.
</dd>
<dt>Deployment-independent client_id with pre-registered redirect_uri and with client_secret</dt>
<dd>This is an option for native applications only, since web application would require different redirect URIs. This category is not advisable because the client secret cannot be protected appropriately (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#ObtainClientSecrets">Section&nbsp;4.1.1<span> (</span><span class="info">Threat: Obtain Client Secrets</span><span>)</span></a>). Due to its security weaknesses, such client identities have the same trust level as deployment-independent clients without secret. Revocation will affect ALL deployments.
</dd>
<dt>Deployment-specific client_id with pre-registered redirect_uri and with client_secret</dt>
<dd>The client registration process ensures the validation of the client's properties, such as redirection URI, website address, web site name, contacts. Such a client identity can be utilized for all relevant use cases cited above. This level can be achieved for web applications in combination with a manual or user-bound registration process. Achieving this level for native applications is much more difficult. Either the installation of the application is conducted by an administrator, who validates the client's authenticity, or the process from validating the application to the installation of the application on the device and the creation of the client credentials is controlled end-to-end by a single entity (e.g. application market provider). Revocation will affect a single deployment only.
</dd>
<dt>Deployment-specific client_id with client_secret without validated properties</dt>
<dd>Such a client can be recognized by the authorization server in transactions with subsequent requests (e.g. authorization and token issuance, refresh token issuance and access token refreshment). The authorization server cannot assure any property of the client to end-users. Automatic processing of re-authorizations could be allowed as well. Such client credentials can be generated automatically without any validation of client properties, which makes it another option especially for native applications. Revocation will affect a single deployment only.
</dd>
</dl></blockquote>

<a name="anchor19"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Security Threat Model</h3>

<p>This section gives a comprehensive threat model of OAuth 2.0. Threats are grouped first by attacks directed against an OAuth component, which are client, authorization server, and resource server. Subsequently, they are grouped by flow, e.g. obtain token or access protected resources. Every countermeasure description refers to a detailed description in <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#security_considerations">Section&nbsp;5<span> (</span><span class="info">Security Considerations</span><span>)</span></a>.
</p>
<a name="anchor20"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Clients</h3>

<p>This section describes possible threats directed to OAuth clients.
</p>
<a name="ObtainClientSecrets"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.1.1"></a><h3>4.1.1.&nbsp;
Threat: Obtain Client Secrets</h3>

<p>The attacker could try to get access to the secret of a particular client in order to:
</p>
<p></p>
<ul class="text">
<li>replay its refresh tokens and authorization codes, or
</li>
<li>obtain tokens on behalf of the attacked client with the privileges of that client.
</li>
</ul><p>The resulting impact would be:
</p>
<p></p>
<ul class="text">
<li>Client authentication of access to authorization server can be bypassed
</li>
<li>Stolen refresh tokens or authorization codes can be replayed
</li>
</ul><p>Depending on the client category, the following attacks could be utilized to obtain the client secret.
</p>
<p><br>
<br>
Attack: Obtain Secret From Source Code or Binary:
</p>
<p>This applies for all client types. For open source projects, secrets can be extracted directly from source code in their public repositories. Secrets can be extracted from application binaries just as easily when published source is not available to the attacker. Even if an application takes significant measures to obfuscate secrets in their application distribution one should consider that the secret can still be reverse-engineered by anyone with access to a complete functioning application bundle or binary.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>Don't issue secrets to public clients or clients with inappropriate security policy - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#dont_issue">Section&nbsp;5.2.3.1<span> (</span><span class="info">Don't issue secrets to public clients or clients with inappropriate security policy</span><span>)</span></a>
</li>
<li>Public clients require user consent - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#forced_user_consent">Section&nbsp;5.2.3.2<span> (</span><span class="info">Public clients without secret require user consent</span><span>)</span></a>
</li>
<li>Use deployment-specific client secrets - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#depl_specific_secretes">Section&nbsp;5.2.3.4<span> (</span><span class="info">Deployment-specific client secrets</span><span>)</span></a>
</li>
<li>Client secret revocation - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#client_secret_revocation">Section&nbsp;5.2.3.6<span> (</span><span class="info">Client secret revocation</span><span>)</span></a>
</li>
</ul>

<p><br>
<br>
Attack: Obtain a Deployment-Specific Secret:
</p>
<p>An attacker may try to obtain the secret from a client installation, either from a web site (web server) or a particular devices (native application).
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>Web server: apply standard web server protection measures (for config files and databases) - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#std_web">Section&nbsp;5.3.2<span> (</span><span class="info">Standard web server protection measures (for config files and databases)</span><span>)</span></a>
</li>
<li>Native applications: Store secrets in a secure local storage - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#secure_storage">Section&nbsp;5.3.3<span> (</span><span class="info">Store secrets in a secure storage</span><span>)</span></a>
</li>
<li>Client secret revocation - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#client_secret_revocation">Section&nbsp;5.2.3.6<span> (</span><span class="info">Client secret revocation</span><span>)</span></a>
</li>
</ul>

<a name="anchor21"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.1.2"></a><h3>4.1.2.&nbsp;
Threat: Obtain Refresh Tokens</h3>

<p>Depending on the client type, there are different ways refresh tokens may be revealed to an attacker. The following sub-sections give a more detailed description of the different attacks with respect to different client types and further specialized countermeasures. Before detailing those threats, here are some generally applicable countermeasures:
</p>
<p></p>
<ul class="text">
<li>The authorization server should validate the client id associated with the particular refresh token with every refresh request- <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#binding_refresh_client_id">Section&nbsp;5.2.2.2<span> (</span><span class="info">Binding of refresh token to client_id</span><span>)</span></a>
</li>
<li>Limited scope tokens - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#limit_scope">Section&nbsp;5.1.5.1<span> (</span><span class="info">Limit token scope</span><span>)</span></a>
</li>
<li>Refresh token revocation - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#refresh_revocation">Section&nbsp;5.2.2.4<span> (</span><span class="info">Refresh Token Revocation</span><span>)</span></a>
</li>
<li>Client secret revocation - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#client_secret_revocation">Section&nbsp;5.2.3.6<span> (</span><span class="info">Client secret revocation</span><span>)</span></a>
</li>
<li>Refresh tokens can automatically be replaced in order to detect unauthorized token usage by another party (Refresh Token Rotation) - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#refresh_replace">Section&nbsp;5.2.2.3<span> (</span><span class="info">Refresh Token Rotation</span><span>)</span></a>
</li>
</ul>

<p><br>
<br>
Attack: Obtain Refresh Token from Web application:
</p>
<p>An attacker may obtain the refresh tokens issued to a web application by way of overcoming the web server's security controls. Impact: Since a web application manages the user accounts of a certain site, such an attack would result in an exposure of all refresh tokens on that side to the attacker.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>Standard web server protection measures - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#std_web">Section&nbsp;5.3.2<span> (</span><span class="info">Standard web server protection measures (for config files and databases)</span><span>)</span></a>
</li>
<li>Use strong client authentication (e.g. client_assertion / client_token), so the attacker cannot obtain the client secret required to exchange the tokens - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#strong_client_authn">Section&nbsp;5.2.3.7<span> (</span><span class="info">Use strong client authentication (e.g. client_assertion / client_token)</span><span>)</span></a>
</li>
</ul>

<p><br>
<br>
Attack: Obtain Refresh Token from Native clients:
</p>
<p>On native clients, leakage of a refresh token typically affects a single user, only.
</p>
<p>Read from local file system: The attacker could try get file system access on the device and read the refresh tokens. The attacker could utilize a malicious application for that purpose.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>Store secrets in a secure storage - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#secure_storage">Section&nbsp;5.3.3<span> (</span><span class="info">Store secrets in a secure storage</span><span>)</span></a>
</li>
<li>Utilize device lock to prevent unauthorized device access - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#device_lock">Section&nbsp;5.3.4<span> (</span><span class="info">Utilize device lock to prevent unauthorized device access</span><span>)</span></a>
</li>
</ul>

<p><br>
<br>
Attack: Steal device:
</p>
<p>The host device (e.g. mobile phone) may be stolen. In that case, the attacker gets access to all applications under the identity of the legitimate user.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>Utilize device lock to prevent unauthorized device access - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#device_lock">Section&nbsp;5.3.4<span> (</span><span class="info">Utilize device lock to prevent unauthorized device access</span><span>)</span></a>
</li>
<li>Where a user knows the device has been stolen, they can revoke the affected tokens - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#refresh_revocation">Section&nbsp;5.2.2.4<span> (</span><span class="info">Refresh Token Revocation</span><span>)</span></a>
</li>
</ul>

<p><br>
<br>
Attack: Clone Device:
</p>
<p>All device data and applications are copied to another device. Applications are used as-is on the target device.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>Utilize device lock to prevent unauthorized device access - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#device_lock">Section&nbsp;5.3.4<span> (</span><span class="info">Utilize device lock to prevent unauthorized device access</span><span>)</span></a>
</li>
<li>Combine refresh token request with device identification - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#device_id">Section&nbsp;5.2.2.5<span> (</span><span class="info">Device identification</span><span>)</span></a>
</li>
<li>Refresh Token Rotation - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#refresh_replace">Section&nbsp;5.2.2.3<span> (</span><span class="info">Refresh Token Rotation</span><span>)</span></a>
</li>
<li>Where a user knows the device has been cloned, they can use this countermeasure - Refresh Token Revocation - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#refresh_revocation">Section&nbsp;5.2.2.4<span> (</span><span class="info">Refresh Token Revocation</span><span>)</span></a>
</li>
</ul>

<a name="anchor22"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.1.3"></a><h3>4.1.3.&nbsp;
Threat: Obtain Access Tokens</h3>

<p>Depending on the client type, there are different ways access tokens may be revealed to an attacker. Access tokens could be stolen from the device if the application stores them in a storage, which is accessible to other applications.
</p>
<p>Impact: Where the token is a bearer token and no additional mechanism is used to identify the client, the attacker can access all resources associated with the token and its scope.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>Keep access tokens in transient memory and limit grants: <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#access_tokens">Section&nbsp;5.1.6<span> (</span><span class="info">Access tokens</span><span>)</span></a>
</li>
<li>Limited scope tokens - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#limit_scope">Section&nbsp;5.1.5.1<span> (</span><span class="info">Limit token scope</span><span>)</span></a>
</li>
<li>Keep access tokens in private memory or apply same protection means as for refresh tokens - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#refresh_tokens">Section&nbsp;5.2.2<span> (</span><span class="info">Refresh tokens</span><span>)</span></a>
</li>
<li>Keep access token lifetime short - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#short_exp_time">Section&nbsp;5.1.5.3<span> (</span><span class="info">Short expiration time</span><span>)</span></a>
</li>
</ul>

<a name="anchor23"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.1.4"></a><h3>4.1.4.&nbsp;
Threat: End-user credentials phished using compromised or embedded browser</h3>

<p>A malicious application could attempt to phish end-user passwords by misusing an embedded browser in the end-user authorization process, or by presenting its own user-interface instead of allowing trusted system browser to render the authorization user interface. By doing so, the usual visual trust mechanisms may be bypassed (e.g. TLS confirmation, web site mechanisms). By using an embedded or internal client application user interface, the client application has access to additional information it should not have access to (e.g. uid/password).
</p>
<p>Impact: If the client application or the communication is compromised, the user would not be aware and all information in the authorization exchange could be captured such as username and password.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>The OAuth flow is designed so that client applications never need to know user passwords. Client applications should avoid directly asking users for the their credentials. In addition, end users could be educated about phishing attacks and best practices, such as only accessing trusted clients, as OAuth does not provide any protection against malicious applications and the end user is solely responsible for the trustworthiness of any native application installed.
</li>
<li>Client applications could be validated prior to publication in an application market for users to access. That validation is out of scope for OAuth but could include validating that the client application handles user authentication in an appropriate way.
</li>
<li>Client developers should not write client applications that collect authentication information directly from users and should instead delegate this task to a trusted system component, e.g. the system-browser.
</li>
</ul>

<a name="open_redirector_client"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.1.5"></a><h3>4.1.5.&nbsp;
Threat: Open Redirectors on client</h3>

<p>An open redirector is an endpoint using a parameter to automatically redirect a user-agent to the location specified by the parameter value without any validation. If the authorization server allows the client to register only part of the redirection URI, an attacker can use an open redirector operated by the client to construct a redirection URI that will pass the authorization server validation but will send the authorization code or access token to an endpoint under the control of the attacker.
</p>
<p>Impact: An attacker could gain access to authorization codes or access tokens
</p>
<p>Countermeasure
</p>
<p></p>
<ul class="text">
<li>require clients to register full redirection URI <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#val_redirect">Section&nbsp;5.2.3.5<span> (</span><span class="info">Validation of pre-registered redirect_uri</span><span>)</span></a>
</li>
</ul>

<a name="anchor24"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Authorization Endpoint</h3>

<p>
</p>
<a name="anchor25"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.2.1"></a><h3>4.2.1.&nbsp;
Threat: Password phishing by counterfeit authorization server</h3>

<p>OAuth makes no attempt to verify the authenticity of the Authorization Server. A hostile party could take advantage of this by intercepting the Client's requests and returning misleading or otherwise incorrect responses. This could be achieved using DNS or ARP spoofing. Wide deployment of OAuth and similar protocols may cause Users to become inured to the practice of being redirected to websites where they are asked to enter their passwords. If Users are not careful to verify the authenticity of these websites before entering their credentials, it will be possible for attackers to exploit this practice to steal Users' passwords.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>Authorization servers should consider such attacks when developing services based on OAuth, and should require transport-layer security for any requests where the authenticity of the authorization server or of request responses is an issue (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#server_authn">Section&nbsp;5.1.2<span> (</span><span class="info">Server authentication</span><span>)</span></a>).
</li>
<li>Authorization servers should attempt to educate Users about the risks phishing attacks pose, and should provide mechanisms that make it easy for users to confirm the authenticity of their sites.
</li>
</ul>

<a name="anchor26"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.2.2"></a><h3>4.2.2.&nbsp;
Threat: User unintentionally grants too much access scope</h3>

<p>When obtaining end user authorization, the end-user may not understand the scope of the access being granted and to whom or they may end up providing a client with access to resources which should not be permitted.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>Explain the scope (resources and the permissions) the user is about to grant in a understandable way - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#informed_decisions">Section&nbsp;5.2.4.2<span> (</span><span class="info">Informed decisions based on transparency</span><span>)</span></a>
</li>
<li>Narrow scope based on client - When obtaining end user authorization and where the client requests scope, the authorization server may want to consider whether to honour that scope based on who the client is. That decision is between the client and authorization server and is outside the scope of this spec. The authorization server may also want to consider what scope to grant based on the client type, e.g. providing lower scope to public clients. - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#limit_scope">Section&nbsp;5.1.5.1<span> (</span><span class="info">Limit token scope</span><span>)</span></a>
</li>
</ul>

<a name="mal_client3"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.2.3"></a><h3>4.2.3.&nbsp;
Threat: Malicious client obtains existing authorization by fraud</h3>

<p>Authorization servers may wish to automatically process authorization requests from clients which have been previously authorized by the user. When the user is redirected to the authorization server's end-user authorization endpoint to grant access, the authorization server detects that the user has already granted access to that particular client. Instead of prompting the user for approval, the authorization server automatically redirects the user back to the client.
</p>
<p>A malicious client may exploit that feature and try to obtain such an authorization code instead of the legitimate client.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>Authorization servers should not automatically process repeat authorizations to public clients or unless the client is validated using a pre-registered redirect URI (<a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#val_redirect">Section&nbsp;5.2.3.5<span> (</span><span class="info">Validation of pre-registered redirect_uri</span><span>)</span></a> )
</li>
<li>Authorization servers can mitigate the risks associated with automatic processing by limiting the scope of Access Tokens obtained through automated approvals - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#limit_scope">Section&nbsp;5.1.5.1<span> (</span><span class="info">Limit token scope</span><span>)</span></a>
</li>
</ul>

<a name="open_redirector"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.2.4"></a><h3>4.2.4.&nbsp;
Threat: Open redirector</h3>

<p>An attacker could use the end-user authorization endpoint and the redirection URI parameter to abuse the authorization server as an open redirector. An open redirector is an endpoint using a parameter to automatically redirect a user-agent to the location specified by the parameter value without any validation.
</p>
<p>Impact: An attacker could utilize a user's trust in your authorization server to launch a phishing attack.
</p>
<p>Countermeasure
</p>
<p></p>
<ul class="text">
<li>require clients to register full redirection URI <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#val_redirect">Section&nbsp;5.2.3.5<span> (</span><span class="info">Validation of pre-registered redirect_uri</span><span>)</span></a>
</li>
<li>don't redirect to redirection URI, if client identity or redirection URI can't be verified <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#val_redirect">Section&nbsp;5.2.3.5<span> (</span><span class="info">Validation of pre-registered redirect_uri</span><span>)</span></a>
</li>
</ul>

<a name="anchor27"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Token endpoint</h3>

<p>
</p>
<a name="anchor28"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.3.1"></a><h3>4.3.1.&nbsp;
Threat: Eavesdropping access tokens</h3>

<p>Attackers may attempts to eavesdrop access token on transit from the authorization server to the client.
</p>
<p>Impact: The attacker is able to access all resources with the permissions covered by the scope of the particular access token.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>As per the core OAuth spec, the authorization servers must ensure that these transmissions are protected using transport-layer mechanisms such as TLS or SSL (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#conf_requests">Section&nbsp;5.1.1<span> (</span><span class="info">Confidentiality of Requests</span><span>)</span></a>).
</li>
<li>If end-to-end confidentiality cannot be guaranteed, reducing scope (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#limit_scope">Section&nbsp;5.1.5.1<span> (</span><span class="info">Limit token scope</span><span>)</span></a>) and expiry time (<a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#short_exp_time">Section&nbsp;5.1.5.3<span> (</span><span class="info">Short expiration time</span><span>)</span></a>) for access tokens can be used to reduce the damage in case of leaks.
</li>
</ul>

<a name="anchor29"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.3.2"></a><h3>4.3.2.&nbsp;
Threat: Obtain access tokens from authorization server database</h3>

<p>This threat is applicable if the authorization server stores access tokens as handles in a database. An attacker may obtain access tokens from the authorization server's database by gaining access to the database or launching a SQL injection attack. Impact: disclosure of all access tokens
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>System security measures - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#std_sys">Section&nbsp;5.1.4.1.1<span> (</span><span class="info">Standard System Security Means</span><span>)</span></a>
</li>
<li>Store access token hashes only - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#noclear">Section&nbsp;5.1.4.1.3<span> (</span><span class="info">No cleartext storage of credentials</span><span>)</span></a>
</li>
<li>Standard SQL injection Countermeasures - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#std_sql">Section&nbsp;5.1.4.1.2<span> (</span><span class="info">Standard SQL Injection Countermeasures</span><span>)</span></a>
</li>
</ul>

<a name="anchor30"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.3.3"></a><h3>4.3.3.&nbsp;
Threat: Obtain client credentials over non secure transport</h3>

<p>An attacker could attempt to eavesdrop the transmission of client credentials between client and server during the client authentication process or during OAuth token requests. Impact: Revelation of a client credential enabling the possibility for phishing or imitation of a client service.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>Implement transport security through - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#conf_requests">Section&nbsp;5.1.1<span> (</span><span class="info">Confidentiality of Requests</span><span>)</span></a>
</li>
<li>Alternative authentication means, which do not require to send plaintext credentials over the wire (Examples: Digest authentication)
</li>
</ul>

<a name="anchor31"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.3.4"></a><h3>4.3.4.&nbsp;
Threat: Obtain client secret from authorization server database</h3>

<p>An attacker may obtain valid client_id/secret combinations from the authorization server's database by gaining access to the database or launching a SQL injection attack. Impact: disclosure of all client_id/secret combinations. This allows the attacker to act on behalf of legitimate clients.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>Ensure proper handling of credentials as per <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#cred_storage_prot">Credential Storage Protection<span> (</span><span class="info">Credential Storage Protection</span><span>)</span></a>.
</li>
</ul>

<a name="anchor32"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.3.5"></a><h3>4.3.5.&nbsp;
Threat: Obtain client secret by online guessing</h3>

<p>An attacker may try to guess valid client_id/secret pairs. Impact: disclosure of single client_id/secret pair.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>High entropy of secrets - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#high_entropy">Section&nbsp;5.1.4.2.2<span> (</span><span class="info">High entropy of secrets</span><span>)</span></a>
</li>
<li>Lock accounts - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#lock_accounts">Section&nbsp;5.1.4.2.3<span> (</span><span class="info">Lock accounts</span><span>)</span></a>
</li>
<li>Use Strong Client Authentication - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#strong_client_authn">Section&nbsp;5.2.3.7<span> (</span><span class="info">Use strong client authentication (e.g. client_assertion / client_token)</span><span>)</span></a>
</li>
</ul>

<a name="anchor33"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.3.6"></a><h3>4.3.6.&nbsp;
Threat: DoS on dynamic client secret creation</h3>

<p>If an authorization servers includes a nontrivial amount of entropy in client secrets and if the authorization server automatically grants them, an attacker could exhaust the pool by repeatedly applying for them.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>The authorization server should consider some verification step for new clients. The authorization server should include a nontrivial amount of entropy in client secrets.
</li>
</ul>

<a name="anchor34"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
Obtaining Authorization</h3>

<p>This section covers threats which are specific to certain flows utilized to obtain access tokens. Each flow is characterized by response types and/or grant types on the end-user authorization and tokens endpoint, respectively.
</p>
<a name="code_flow"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.4.1"></a><h3>4.4.1.&nbsp;
Authorization Code</h3>

<a name="eavesdropping"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.4.1.1"></a><h3>4.4.1.1.&nbsp;
Threat: Eavesdropping or leaking authorization codes</h3>

<p>An attacker could try to eavesdrop transmission of the authorization code between authorization server and client. Furthermore, authorization codes are passed via the browser which may unintentionally leak those codes to untrusted web sites and attackers by different ways:
</p>
<p></p>
<ul class="text">
<li>Referrer headers: browsers frequently pass a “referrer” header when a web page embeds content, or when a user travels from one web page to another web page. These referrer headers may be sent even when the origin site does not trust the destination site. The referrer header is commonly logged for traffic analysis purposes.
</li>
<li>Request logs: web server request logs commonly include query parameters on requests.
</li>
<li>Open redirectors: web sites sometimes need to send users to another destination via a redirector. Open redirectors pose a particular risk to web-based delegation protocols because the redirector can leak verification codes to untrusted destination sites.
</li>
<li>Browser history: web browsers commonly record visited URLs in the browser history. Another user of the same web browser may be able to view URLs that were visited by previous users.
</li>
</ul><p>Note: A description of a similar attacks on the SAML protocol can be found at http://www.oasis-open.org/committees/download.php/3405/oasis-sstc-saml-bindings-1.1.pdf (§4.1.1.9.1), http://www.thomasgross.net/publications/papers/GroPfi2006-SAML2_Analysis_Janus.WSSS_06.pdf and http://www.oasis-open.org/committees/download.php/11191/sstc-gross-sec-analysis-response-01.pdf.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>As per the core OAuth spec, the authorization server as well as the client must ensure that these transmissions are protected using transport-layer mechanisms such as TLS or SSL (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#conf_requests">Section&nbsp;5.1.1<span> (</span><span class="info">Confidentiality of Requests</span><span>)</span></a>).
</li>
<li>The authorization server will require the client to authenticate wherever possible, so the binding of the authorization code to a certain client can be validated in a reliable way (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#bind_code_client_id">Section&nbsp;5.2.4.4<span> (</span><span class="info">Binding of authorization code to client_id</span><span>)</span></a>).
</li>
<li>Limited duration of authorization codes - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#short_exp_time">Section&nbsp;5.1.5.3<span> (</span><span class="info">Short expiration time</span><span>)</span></a>
</li>
<li>The authorization server should enforce a one time usage restriction (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#one_time_usage">Section&nbsp;5.1.5.4<span> (</span><span class="info">Limit number of usages/ One time usage</span><span>)</span></a>).
</li>
<li>If an Authorization Server observes multiple attempts to redeem a authorization code, the Authorization Server may want to revoke all tokens granted based on the authorization code (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#automatic_code_revocation">Section&nbsp;5.2.1.1<span> (</span><span class="info">Automatic revocation of derived tokens if abuse is detected</span><span>)</span></a>).
</li>
<li>In the absence of these countermeasures, reducing scope (<a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#limit_scope">Section&nbsp;5.1.5.1<span> (</span><span class="info">Limit token scope</span><span>)</span></a>) and expiry time (<a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#short_exp_time">Section&nbsp;5.1.5.3<span> (</span><span class="info">Short expiration time</span><span>)</span></a>) for access tokens can be used to reduce the damage in case of leaks.
</li>
<li>The client server may reload the target page of the redirection URI in order to automatically cleanup the browser cache.
</li>
</ul>

<a name="anchor35"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.4.1.2"></a><h3>4.4.1.2.&nbsp;
Threat: Obtain authorization codes from authorization server database</h3>

<p>This threat is applicable if the authorization server stores authorization codes as handles in a database. An attacker may obtain authorization codes from the authorization server's database by gaining access to the database or launching a SQL injection attack. Impact: disclosure of all authorization codes, most likely along with the respective redirect_uri and client_id values.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>Best practices for credential storage protection should be employed - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#cred_storage_prot">Section&nbsp;5.1.4.1<span> (</span><span class="info">Credential Storage Protection</span><span>)</span></a>
</li>
<li>System security measures - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#std_sys">Section&nbsp;5.1.4.1.1<span> (</span><span class="info">Standard System Security Means</span><span>)</span></a>
</li>
<li>Store access token hashes only - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#noclear">Section&nbsp;5.1.4.1.3<span> (</span><span class="info">No cleartext storage of credentials</span><span>)</span></a>
</li>
<li>Standard SQL injection countermeasures - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#std_sql">Section&nbsp;5.1.4.1.2<span> (</span><span class="info">Standard SQL Injection Countermeasures</span><span>)</span></a>
</li>
</ul>

<a name="anchor36"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.4.1.3"></a><h3>4.4.1.3.&nbsp;
Threat: Online guessing of authorization codes</h3>

<p>An attacker may try to guess valid authorization code values and send it using the grant type „code“ in order to obtain a valid access token.
</p>
<p>Impact: disclosure of single access token, probably also associated refresh token.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>Handle-based tokens must use high entropy: <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#random_entropy">Section&nbsp;5.1.5.11<span> (</span><span class="info">Random token value with high entropy</span><span>)</span></a>
</li>
<li>Assertion-based tokens should be signed: <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#signed_tokens">Section&nbsp;5.1.5.9<span> (</span><span class="info">Signed tokens</span><span>)</span></a>
</li>
<li>Authenticate the client, adds another value the attacker has to guess - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#depl_specific_secretes">Section&nbsp;5.2.3.4<span> (</span><span class="info">Deployment-specific client secrets</span><span>)</span></a>
</li>
<li>Binding of authorization code to redirection URI, adds another value the attacker has to guess - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#bind_code_redirect">Section&nbsp;5.2.4.5<span> (</span><span class="info">Binding of authorization code to redirect_uri</span><span>)</span></a>
</li>
<li>Short expiration time - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#short_exp_time">Section&nbsp;5.1.5.3<span> (</span><span class="info">Short expiration time</span><span>)</span></a>
</li>
</ul>

<a name="mal_client"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.4.1.4"></a><h3>4.4.1.4.&nbsp;
Threat: Malicious client obtains authorization</h3>

<p>A malicious client could counterfeit a valid client and obtain an access authorization that way. The malicious client could even utilize screen scraping techniques in order to simulate the user consent in the authorization flow.
</p>
<p>Assumption: It is not the task of the authorization server to protect the end-user's device from malicious software. This is the responsibility of the platform running on the particular device probably in cooperation with other components of the respective ecosystem (e.g. an application management infrastructure). The sole responsibility of the authorization server is to control access to the end-user's resources living in resource servers and to prevent unauthorized access to them. Based on this assumption, the following countermeasures are available to cope with the threat.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>The authorization server should authenticate the client, if possible (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#depl_specific_secretes">Section&nbsp;5.2.3.4<span> (</span><span class="info">Deployment-specific client secrets</span><span>)</span></a>). Note: the authentication takes place after the end-user has authorized the access.
</li>
<li>The authorization server should validate the client's redirection URI against the pre-registered redirection URI, if one exists (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#val_redirect">Section&nbsp;5.2.3.5<span> (</span><span class="info">Validation of pre-registered redirect_uri</span><span>)</span></a>). Note: An invalid redirect URI indicates an invalid client whereas a valid redirect URI not neccesserily indicates a valid client. The level of confidence depends on the client type. For web applications, the confidence is high since the redirect URI refers to the globally unique network endpoint of this application whose address is also validated using HTTPS server authentication by the user agent. In contrast for native clients, the redirect URI typically refers to device local resources, e.g. a custom scheme. So a malicious client on a particular device can use the valid redirect URI the legitimate client uses on all other devices.
</li>
<li>After authenticating the end-user, the authorization server should ask him/her for consent. In this context, the user should be explained the purpose, scope, and duration of the authorization. Moreover, the authorization server should show the user any identity information it has for that client. It is up to the user to validate the binding of this data to the particular application (e.g. Name) and to approve the authorization request. (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#validation_end_user">Section&nbsp;5.2.4.3<span> (</span><span class="info">Validation of client properties by end-user</span><span>)</span></a>).
</li>
<li>The authorization server should not perform automatic re-authorizations for clients it is unable to reliably authenticate or validate (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#automatic_processing">Section&nbsp;5.2.4.1<span> (</span><span class="info">Automatic processing of repeated authorizations requires client validation</span><span>)</span></a>).
</li>
<li>If the authorization server automatically authenticates the end-user, it may nevertheless require some user input in order to prevent screen scraping. Examples are CAPTCHAs or user-specific secrets like PIN codes.
</li>
<li>The authorization server may also limit the scope of tokens it issues to clients it cannot reliably authenticate (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#limit_scope">Section&nbsp;5.1.5.1<span> (</span><span class="info">Limit token scope</span><span>)</span></a>).
</li>
</ul>

<a name="anchor37"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.4.1.5"></a><h3>4.4.1.5.&nbsp;
Threat: Authorization code phishing</h3>

<p>A hostile party could impersonate the client site and get access to the authorization code. This could be achieved using DNS or ARP spoofing. This applies to clients, which are web applications, thus the redirect URI is not local to the host where the user's browser is running.
</p>
<p>Impact: This affects web applications and may lead to a disclosure of authorization codes and, potentially, the corresponding access and refresh tokens.
</p>
<p>Countermeasures:
</p>
<p>It is strongly recommended that one of the following countermeasures is utilized in order to prevent this attack:
</p>
<p></p>
<ul class="text">
<li>The redirection URI of the client should point to a HTTPS protected endpoint and the browser should be utilized to authenticate this redirection URI using server authentication (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#server_authn">Section&nbsp;5.1.2<span> (</span><span class="info">Server authentication</span><span>)</span></a>).
</li>
<li>The authorization server should require the client to be authenticated, i.e. confidential client, so the binding of the authorization code to a certain client can be validated in a reliable way (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#bind_code_client_id">Section&nbsp;5.2.4.4<span> (</span><span class="info">Binding of authorization code to client_id</span><span>)</span></a>).
</li>
</ul>

<a name="anchor38"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.4.1.6"></a><h3>4.4.1.6.&nbsp;
Threat: User session impersonation</h3>

<p>A hostile party could impersonate the client site and impersonate the user's session on this client. This could be achieved using DNS or ARP spoofing. This applies to clients, which are web applications, thus the redirect URI is not local to the host where the user's browser is running.
</p>
<p>Impact: An attacker who intercepts the authorization code as it is sent by the browser to the callback endpoint can gain access to protected resources by submitting the authorization code to the client. The client will exchange the authorization code for an access token and use the access token to access protected resources for the benefit of the attacker, delivering protected resources to the attacker, or modifying protected resources as directed by the attacker. If OAuth is used by the client to delegate authentication to a social site (e.g. as in the implementation of the "Facebook Login" button), the attacker can use the intercepted authorization code to log in to the client as the user.
</p>
<p>Note: Authenticating the client during authorization code exchange will not help to detect such an attack as it is the legitimate client that obtains the tokens.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>In order to prevent an attacker from impersonating the end-users session, the redirection URI of the client should point to a HTTPS protected endpoint and the browser should be utilized to authenticate this redirection URI using server authentication (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#server_authn">Section&nbsp;5.1.2<span> (</span><span class="info">Server authentication</span><span>)</span></a>)
</li>
</ul>

<a name="authz_code_leakage"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.4.1.7"></a><h3>4.4.1.7.&nbsp;
Threat: Authorization code leakage through counterfeit client</h3>

<p>The attack leverages the authorization code grant type in an attempt to get another user (victim) to log-in, authorize access to his/her resources, and subsequently obtain the authorization code and inject it into a client application using the attacker's account. The goal is to associate an access authorization for resources of the victim with the user account of the attacker on a client site.
</p>
<p>The attacker abuses an existing client application and combines it with his own counterfeit client web site. The attack depends on the victim expecting the client application to request access to a certain resource server. The victim, seeing only a normal request from an expected application, approves the request. The attacker then uses the victim's authorization to gain access to the information unknowingly authorized by the victim.
</p>
<p>The attacker conducts the following flow:
</p>
<p></p>
<ol class="text">
<li>The attacker accesses the client web site (or application) and initiates data access to a particular resource server. The client web site in turn initiates an authorization request to the resource server's authorization server. Instead of proceeding with the authorization process, the attacker modifies the authorization server end-user authorization URL as constructed by the client to include a redirection URI parameter referring to a web site under his control (attacker's web site).
</li>
<li>The attacker tricks another user (the victim) to open that modified end-user authorization URI and to authorize access (e.g. an email link, or blog link). The way the attacker achieve that goal is out of scope.
</li>
<li>Having clicked the link, the victim is requested to authenticate and authorize the client site to have access.
</li>
<li>After completion of the authorization process, the authorization server redirects the user agent to the attacker's web site instead of the original client web site.
</li>
<li>The attacker obtains the authorization code from his web site by means out of scope of this document.
</li>
<li>He then constructs a redirection URI to the target web site (or application) based on the original authorization request's redirection URI and the newly obtained authorization code and directs his user agent to this URL. The authorization code is injected into the original client site (or application).
</li>
<li>The client site uses the authorization code to fetch a token from the authorization server and associates this token with the attacker's user account on this site.
</li>
<li>The attacker may now access the victims resources using the client site.
</li>
</ol>

<p>Impact: The attackers gains access to the victim's resources as associated with his account on the client site.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>The attacker will need to use another redirection URI for its authorization process than the target web site because it needs to intercept the flow. So if the authorization server associates the authorization code with the redirection URI of a particular end-user authorization and validates this redirection URI with the redirection URI passed to the token's endpoint, such an attack is detected (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#bind_code_redirect">Section&nbsp;5.2.4.5<span> (</span><span class="info">Binding of authorization code to redirect_uri</span><span>)</span></a>).
</li>
<li>The authorization server may also enforce the usage and validation of pre-registered redirect URIs (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#val_redirect">Section&nbsp;5.2.3.5<span> (</span><span class="info">Validation of pre-registered redirect_uri</span><span>)</span></a>). This will allow for an early recognition of session fixation attempts.
</li>
<li>For native applications, one could also consider to use deployment-specific client ids and secrets (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#depl_specific_secretes">Section&nbsp;5.2.3.4<span> (</span><span class="info">Deployment-specific client secrets</span><span>)</span></a>, along with the binding of authorization code to client_id (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#bind_code_client_id">Section&nbsp;5.2.4.4<span> (</span><span class="info">Binding of authorization code to client_id</span><span>)</span></a>), to detect such an attack because the attacker does not have access the deployment-specific secret. Thus he will not be able to exchange the authorization code.
</li>
<li>The client may consider using other flows, which are not vulnerable to this kind of attacks such as "Implicit Grant" or "Resource Owner Password Credentials" (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#implicite_flow">Section&nbsp;4.4.2<span> (</span><span class="info">Implicit Grant</span><span>)</span></a> or <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#pwd_flow">Section&nbsp;4.4.3<span> (</span><span class="info">Resource Owner Password Credentials</span><span>)</span></a>).
</li>
</ul>

<a name="anchor39"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.4.1.8"></a><h3>4.4.1.8.&nbsp;
Threat: CSRF attack against redirect-uri</h3>

<p>Cross-Site Request Forgery (CSRF) is a web-based attack whereby HTTP requests are transmitted from a user that the website trusts or has authenticated (e.g., via HTTP redirects or HTML forms). CSRF attacks on OAuth approvals can allow an attacker to obtain authorization to OAuth protected resources without the consent of the User.
</p>
<p>This attack works against the redirection URI used in the authorization code flow. An attacker could authorize an authorization code to their own protected resources on an authorization server. He then aborts the redirect flow back to the client on his device and tricks the victim into executing the redirect back to the client. The client receives the redirect, fetches the token(s) from the authorization server and associates the victim's client session with the resources accessible using the token.
</p>
<p>Impact: The user accesses resources on behalf of the attacker. The effective impact depends on the type of resource accessed. For example, the user may upload private items to an attacker's resources. Or when using OAuth in 3rd party login scenarios, the user may associate his client account with the attacker's identity at the external identity provider. This way the attacker could easily access the victim's data at the client by logging in from another device with his credentials at the external identity provider.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>The state parameter should be used to link the authorization request with the redirection URI used to deliver the access token. <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#link_state_uasession">Section&nbsp;5.3.6<span> (</span><span class="info">Link state parameter to user agent session</span><span>)</span></a>
</li>
<li>Client developers and end-user can be educated not follow untrusted URLs.
</li>
</ul>

<a name="anchor40"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.4.1.9"></a><h3>4.4.1.9.&nbsp;
Threat: Clickjacking attack against authorization</h3>

<p>With Clickjacking, a malicious site loads the target site in a transparent iframe overlaid on top of a set of dummy buttons which are carefully constructed to be placed directly under important buttons on the target site. When a user clicks a visible button, they are actually clicking a button (such as an "Authorize" button) on the hidden page.
</p>
<p>Impact: An attacker can steal a user's authentication credentials and access their resources
</p>
<p>Countermeasure
</p>
<p></p>
<ul class="text">
<li>Native applications should use external browsers instead of embedding browsers in a web view when requesting end-user authorization
</li>
<li>For newer browsers, avoidance of iFrames can be enforced server side by using the X-FRAME-OPTION header - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#clickjacking_xframe">Section&nbsp;5.2.2.6<span> (</span><span class="info">X-FRAME-OPTION header</span><span>)</span></a>
</li>
<li>For older browsers, javascript framebusting techniques can be used but may not be effective in all browsers.
</li>
</ul>

<a name="anchor41"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.4.1.10"></a><h3>4.4.1.10.&nbsp;
Threat: Resource Owner Impersonation</h3>

<p>When a client requests access to protected resources, the authorization flow normally involves the resource owner's explicit response to the access request, either granting or denying access to the protected resources. A malicious client can exploit knowledge of the structure of this flow in order to gain authorization without the resource owner's consent, by transmitting the necessary requests programmatically, and simulating the flow against the authorization server. That way, the client may gain access to the victims resources without her approval. An authorization server will be vulnerable to this threat, if it uses non-interactive authentication mechanisms or split the authorization flow across multiple pages.
</p>
<p>The malicious client might embed a hidden HTML user agent, interpret the HTML forms sent by the authorization server, and automatically answer with the corresponding form post requests. As a pre-requisite, the attacker must be able to execute the authorization process in the context of an already authenticated session of the resource owner with the authorization server. There are different ways to achieve this:
</p>
<p></p>
<ul class="text">
<li>The malicious client could abuse an existing session in an external browser or cross-browser cookies on the particular device.
</li>
<li>It could also request authorization for a particular scope and silently abuse the resulting session in his browser instance to "silently" request another scope.
</li>
<li>Alternatively, the attacker might exploit an authorization server's ability to authenticate the resource owner automatically and without user interactions, e.g. based on certificates.
</li>
</ul><p> In all cases, such an attack is limited to clients running on the victim's device, within the user agent or as native app.
</p>
<p>Please note: Such attacks cannot be prevented using CSRF countermeasures, since the attacker just "executes" the URLs as prepared by the authorization server including any nonce etc.
</p>
<p>Countermeasures:
</p>
<p>Authorization servers should decide, based on an analysis of the risk associated with this threat, whether to assume, detect, or to prevent this threat.
</p>
<p>In order to prevent such an attack, the authorization server may force an user interaction based on non-predictable input values as part of the user consent approval. The authorization server could
</p>
<p></p>
<ul class="text">
<li>combine password authentication and user consent in a single form,
</li>
<li>make use of CAPTCHAs, or
</li>
<li>or use one-time secrets send out of bound to the resource owner (e.g. via text or instance message).
</li>
</ul><p> Alternatively in order to allow the resource owner to detect abuse, the authorization server could notify the resource owner of any approval by appropriate means, e.g. text or instant message or e-Mail.
</p>
<a name="anchor42"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.4.1.11"></a><h3>4.4.1.11.&nbsp;
Threat: DoS, Exhaustion of resources attacks</h3>

<p>If an authorization server includes a nontrivial amount of entropy in authorization codes or access tokens (limiting the number of possible codes/tokens) and automatically grants either without user intervention and has no limit on code or access tokens per user, an attacker could exhaust the pool by repeatedly directing user(s) browser to request code or access tokens. This is because more entropy means a larger number of tokens can be issued.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>The authorization server should consider limiting the number of access tokens granted per user. The authorization server should include a nontrivial amount of entropy in authorization codes.
</li>
</ul>

<a name="semi"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.4.1.12"></a><h3>4.4.1.12.&nbsp;
Threat: DoS using manufactured authorization codes</h3>

<p>An attacker who owns a botnet can locate the redirect URIs of clients that listen on HTTP, access them with random authorization codes, and cause a large number of HTTPS connections to be concentrated onto the authorization server. This can result in a DoS attack on the authorization server.
</p>
<p>This attack can still be effective even when CSRF defense/the 'state' parameter are deployed on the client side. With such a defense, the attacker might need to incur an additional HTTP request to obtain a valid CSRF code/ state parameter. This apparently cuts down the effectiveness of the attack by a factor of 2. However, if the HTTPS/HTTP cost ratio is higher than 2 (the cost factor is estimated to be around 3.5x at <a href="http://www.semicomplete.com/blog/geekery/ssl-latency.html">http://www.semicomplete.com/blog/geekery/ssl-latency.html</a>) the attacker still achieves a magnification of resource utilization at the expense of the authorization server.
</p>
<p>Impact: There are a few effects that the attacker can accomplish with this OAuth flow that they cannot easily achieve otherwise.
</p>
<p></p>
<ol class="text">
<li>Connection laundering: With the clients as the relay between the attacker and the authorization server, the authorization server learns little or no information about the identity of the attacker. Defenses such rate limiting on the offending attacker machines are less effective due to the difficulty to identify the attacking machines. Although an attacker could also launder its connections through an anonymizing systems such as Tor, the effectiveness of that approach depends on the capacity of the annoying system. On the other hand, a potentially large number of OAuth clients could be utilized for this attack.
</li>
<li>Asymmetric resource utilization: The attacker incurs the cost of an HTTP connection and causes an HTTPS connection to be made on the authorization server; and the attacker can co-ordinate the timing of such HTTPS connections across multiple clients relatively easily. Although the attacker could achieve something similar, say, by including an iframe pointing to the HTTPS URL of the authorization server in an HTTP web page and lure web users to visit that page, timing attacks using such a scheme may be more difficult as it seems nontrivial to synchronize a large number of users to simultaneously visit a particular site under the attacker's control.
</li>
</ol><p>Countermeasures
</p>
<p></p>
<ul class="text">
<li>Though not a complete countermeasure by themselves, CSRF defense and the 'state' parameter created with secure random codes should be deployed on the client side. The client should forward the authorization code to the authorization server only after both the CSRF token and the 'state' parameter are validated.
</li>
<li>If the client authenticates the user, either through a single sign on protocol ( such as OpenID / Facebook Connect ) or through local authentication, the client should suspend the access by a user account if the number of invalid authorization codes submitted by this user exceeds a certain threshold.
</li>
<li>The authorization server should send an error response to the client reporting an invalid authorization code and rate limit or disallow connections from clients whose number of invalid requests exceeds a threshold.
</li>
<li>The authorization server may in addition sign the authorization code using the public key from its SSL certificate, and require the client to validate the signature. To enhance interoperability between multiple clients and authorization servers, a standard procedure to create and validate the signature (including what attributes to sign) may be developed and agreed between the clients and the servers.
</li>
</ul>

<a name="implicite_flow"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.4.2"></a><h3>4.4.2.&nbsp;
Implicit Grant</h3>

<p>In the implicit grant type flow, the access token is directly returned to the client as a fragment part of the redirection URI. It is assumed that the token is not sent to the redirection URI target as HTTP user agents do not send the fragment part of URIs to HTTP servers. Thus an attacker cannot eavesdrop the access token on this communication path and It cannot leak through HTTP referee headers.
</p>
<a name="anchor43"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.4.2.1"></a><h3>4.4.2.1.&nbsp;
Threat: Access token leak in transport/end-points</h3>

<p>This token might be eavesdropped by an attacker. The token is sent from server to client via a URI fragment of the redirection URI. If the communication is not secured or the end-point is not secured, the token could be leaked by parsing the returned URI.
</p>
<p>Impact: the attacker would be able to assume the same rights granted by the token.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>The authorization server should ensure confidentiality of the response from the authorization server to the client (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#conf_requests">Section&nbsp;5.1.1<span> (</span><span class="info">Confidentiality of Requests</span><span>)</span></a>).
</li>
</ul>

<a name="anchor44"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.4.2.2"></a><h3>4.4.2.2.&nbsp;
Threat: Access token leak in browser history</h3>

<p>An attacker could obtain the token from the browser's history. Note this means the attacker needs access to the particular device.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>Shorten token duration (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#short_exp_time">Section&nbsp;5.1.5.3<span> (</span><span class="info">Short expiration time</span><span>)</span></a>) and reduced scope of the token may reduce the impact of that attack (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#limit_scope">Section&nbsp;5.1.5.1<span> (</span><span class="info">Limit token scope</span><span>)</span></a>).
</li>
<li>Make these requests non-cachable
</li>
<li>Native applications can directly embed a browser widget and therewith gain full control of the cache. So the application can cleanup browser history after authorization process.
</li>
</ul>

<a name="mal_client2"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.4.2.3"></a><h3>4.4.2.3.&nbsp;
Threat: Malicious client obtains authorization</h3>

<p>An malicious client could attempt to obtain a token by fraud.
</p>
<p>The same countermeasures as for <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#mal_client">Section&nbsp;4.4.1.4<span> (</span><span class="info">Threat: Malicious client obtains authorization</span><span>)</span></a> are applicable, except client authentication.
</p>
<a name="anchor45"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.4.2.4"></a><h3>4.4.2.4.&nbsp;
Threat: Manipulation of scripts</h3>

<p>A hostile party could act as the client web server and replace or modify the actual implementation of the client (script). This could be achieved using DNS or ARP spoofing. This applies to clients implemented within the Web Browser in a scripting language.
</p>
<p>Impact: The attacker could obtain user credential information and assume the full identity of the user.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>The authorization server should authenticate the server from which scripts are obtained (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#server_authn">Section&nbsp;5.1.2<span> (</span><span class="info">Server authentication</span><span>)</span></a>).
</li>
<li>The client should ensure that scripts obtained have not been altered in transport (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#conf_requests">Section&nbsp;5.1.1<span> (</span><span class="info">Confidentiality of Requests</span><span>)</span></a>).
</li>
<li>Introduce one time per-use secrets (e.g. client_secret) values that can only be used by scripts in a small time window once loaded from a server. The intention would be to reduce the effectiveness of copying client-side scripts for re-use in an attackers modified code.
</li>
</ul>

<a name="anchor46"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.4.2.5"></a><h3>4.4.2.5.&nbsp;
Threat: CSRF attack against redirect-uri</h3>

<p>Cross-Site Request Forgery (CSRF) is a web-based attack whereby HTTP requests are transmitted from a user that the website trusts or has authenticated (e.g., via HTTP redirects or HTML forms). CSRF attacks on OAuth approvals can allow an attacker to obtain authorization to OAuth protected resources without the consent of the User.
</p>
<p>This attack works against the redirection URI used in the implicit grant flow. An attacker could acquire an access token to their own protected resources. He could then construct a redirection URI and embed their access token in that URI. If he can trick the user into following the redirection URI and the client does not have protection against this attack, the user may have the attacker's access token authorized within their client.
</p>
<p>Impact: The user accesses resources on behalf of the attacker. The effective impact depends on the type of resource accessed. For example, the user may upload private items to an attacker's resources. Or when using OAuth in 3rd party login scenarios, the user may associate his client account with the attacker's identity at the external identity provider. This way the attacker could easily access the victim's data at the client by logging in from another device with his credentials at the external identity provider.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>The state parameter should be used to link the authorization request with the redirection URI used deliver the access token. This will ensure the client is not tricked into completing any redirect callback unless it is linked to an authorization request the client initiated. The state parameter should be unguessable and the client should be capable of keeping the state parameter secret.
</li>
<li>Client developers and end-user can be educated not follow untrusted URLs.
</li>
</ul>

<a name="pwd_flow"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.4.3"></a><h3>4.4.3.&nbsp;
Resource Owner Password Credentials</h3>

<p>The “Resource Owner Password Credentials” grant type (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#I-D.ietf-oauth-v2">[I‑D.ietf‑oauth‑v2]<span> (</span><span class="info">Hammer, E., Recordon, D., and D. Hardt, “The OAuth 2.0 Authorization Protocol,” January&nbsp;2012.</span><span>)</span></a>, Section 4.3), often used for legacy/migration reasons, allows a client to request an access token using an end-users user-id and password along with its own credential. This grant type has higher risk because it maintains the uid/password anti-pattern. Additionally, because the user does not have control over the authorization process, clients using this grant type are not limited by scope, but instead have potentially the same capabilities as the user themselves. As there is no authorization step, the ability to offer token revocation is bypassed.
</p>
<p>Impact: The resource server can only differentiate scope based on the access token being associated with a particular client. The client could also acquire long-living tokens and pass them up to a attacker web service for further abuse. The client, eavesdroppers, or end-points could eavesdrop user id and password.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>Except for migration reasons, minimize use of this grant type
</li>
<li>The authorization server should validate the client id associated with the particular refresh token with every refresh request - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#binding_refresh_client_id">Section&nbsp;5.2.2.2<span> (</span><span class="info">Binding of refresh token to client_id</span><span>)</span></a>
</li>
<li>As per the core Oauth spec, the authorization server must ensure that these transmissions are protected using transport-layer mechanisms such as TLS or SSL (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#conf_requests">Section&nbsp;5.1.1<span> (</span><span class="info">Confidentiality of Requests</span><span>)</span></a>).
</li>
</ul>

<a name="anchor47"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.4.3.1"></a><h3>4.4.3.1.&nbsp;
Threat: Accidental exposure of passwords at client site</h3>

<p>If the client does not provide enough protection, an attacker or disgruntled employee could retrieve the passwords for a user.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>Use other flows, which do not rely on the client's cooperation for secure resource owner credential handling
</li>
<li>Use digest authentication instead of plaintext credential processing
</li>
<li>Obfuscation of passwords in logs
</li>
</ul>

<a name="anchor48"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.4.3.2"></a><h3>4.4.3.2.&nbsp;
Threat: Client obtains scopes without end-user authorization</h3>

<p>All interaction with the resource owner is performed by the client. Thus it might, intentionally or unintentionally, happen that the client obtains a token with scope unknown for or unintended by the resource owner. For example, the resource owner might think the client needs and acquires read-only access to its media storage only but the client tries to acquire an access token with full access permissions.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>Use other flows, which do not rely on the client's cooperation for resource owner interaction
</li>
<li>The authorization server may generally restrict the scope of access tokens (<a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#limit_scope">Section&nbsp;5.1.5.1<span> (</span><span class="info">Limit token scope</span><span>)</span></a>) issued by this flow. If the particular client is trustworthy and can be authenticated in a reliable way, the authorization server could relax that restriction. Resource owners may prescribe (e.g. in their preferences) what the maximum scope is for clients using this flow.
</li>
<li>The authorization server could notify the resource owner by an appropriate media, e.g. e-Mail, of the grant issued (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#informed">Section&nbsp;5.1.3<span> (</span><span class="info">Always keep the resource owner informed</span><span>)</span></a>).
</li>
</ul>

<a name="anchor49"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.4.3.3"></a><h3>4.4.3.3.&nbsp;
Threat: Client obtains refresh token through automatic authorization</h3>

<p>All interaction with the resource owner is performed by the client. Thus it might, intentionally or unintentionally, happen that the client obtains a long-term authorization represented by a refresh token even if the resource owner did not intend so.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>Use other flows, which do not rely on the client's cooperation for resource owner interaction
</li>
<li>The authorization server may generally refuse to issue refresh tokens in this flow (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#restricted_refresh">Section&nbsp;5.2.2.1<span> (</span><span class="info">Restricted issuance of refresh tokens</span><span>)</span></a>). If the particular client is trustworthy and can be authenticated in a reliable way (see client authentication), the authorization server could relax that restriction. Resource owners may allow or deny (e.g. in their preferences) to issue refresh tokens using this flow as well.
</li>
<li>The authorization server could notify the resource owner by an appropriate media, e.g. e-Mail, of the refresh token issued (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#informed">Section&nbsp;5.1.3<span> (</span><span class="info">Always keep the resource owner informed</span><span>)</span></a>).
</li>
</ul>

<a name="anchor50"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.4.3.4"></a><h3>4.4.3.4.&nbsp;
Threat: Obtain user passwords on transport</h3>

<p>An attacker could attempt to eavesdrop the transmission of end-user credentials with the grant type „password“ between client and server.
</p>
<p>Impact: disclosure of a single end-users password.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>Confidentiality of Requests - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#conf_requests">Section&nbsp;5.1.1<span> (</span><span class="info">Confidentiality of Requests</span><span>)</span></a>
</li>
<li>alternative authentication means, which do not require to send plaintext credentials over the wire (Examples: Digest authentication)
</li>
</ul>

<a name="anchor51"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.4.3.5"></a><h3>4.4.3.5.&nbsp;
Threat: Obtain user passwords from authorization server database</h3>

<p>An attacker may obtain valid username/password combinations from the authorization server's database by gaining access to the database or launching a SQL injection attack.
</p>
<p>Impact: disclosure of all username/password combinations. The impact may exceed the domain of the authorization server since many users tend to use the same credentials on different services.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>Credential storage protection can be employed - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#cred_storage_prot">Section&nbsp;5.1.4.1<span> (</span><span class="info">Credential Storage Protection</span><span>)</span></a>
</li>
</ul>

<a name="anchor52"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.4.3.6"></a><h3>4.4.3.6.&nbsp;
Threat: Online guessing</h3>

<p>An attacker may try to guess valid username/password combinations using the grant type „password“.
</p>
<p>Impact: Revelation of a single username/password combination.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>Password policy - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#pwd_policy">Section&nbsp;5.1.4.2.1<span> (</span><span class="info">Password policy</span><span>)</span></a>
</li>
<li>Lock accounts - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#lock_accounts">Section&nbsp;5.1.4.2.3<span> (</span><span class="info">Lock accounts</span><span>)</span></a>
</li>
<li>Tar pit - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#tar_pit">Section&nbsp;5.1.4.2.4<span> (</span><span class="info">Tar pit</span><span>)</span></a>
</li>
<li>CAPTCHA - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#captchas">Section&nbsp;5.1.4.2.5<span> (</span><span class="info">Usage of CAPTCHAs</span><span>)</span></a>
</li>
<li>Abandon on grant type „password“
</li>
<li>Client authentication (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#client_aa">Section&nbsp;5.2.3<span> (</span><span class="info">Client authentication and authorization</span><span>)</span></a>) will provide another authentication factor and thus hinder the attack.
</li>
</ul>

<a name="anchor53"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.4.4"></a><h3>4.4.4.&nbsp;
Client Credentials</h3>

<p>Client credentials (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#I-D.ietf-oauth-v2">[I‑D.ietf‑oauth‑v2]<span> (</span><span class="info">Hammer, E., Recordon, D., and D. Hardt, “The OAuth 2.0 Authorization Protocol,” January&nbsp;2012.</span><span>)</span></a>, Section 3) consist of an identifier (not secret) combined with an additional means (such as a matching client secret) of authenticating a client. The threats to this grant type are similar to <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#pwd_flow">Section&nbsp;4.4.3<span> (</span><span class="info">Resource Owner Password Credentials</span><span>)</span></a>.
</p>
<a name="anchor54"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.5"></a><h3>4.5.&nbsp;
Refreshing an Access Token</h3>

<a name="anchor55"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.5.1"></a><h3>4.5.1.&nbsp;
Threat: Eavesdropping refresh tokens from authorization server</h3>

<p>An attacker may eavesdrop refresh tokens when they are transmitted from the authorization server to the client.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>As per the core OAuth spec, the Authorization servers must ensure that these transmissions are protected using transport-layer mechanisms such as TLS or SSL (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#conf_requests">Section&nbsp;5.1.1<span> (</span><span class="info">Confidentiality of Requests</span><span>)</span></a>).
</li>
<li>If end-to-end confidentiality cannot be guaranteed, reducing scope (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#limit_scope">Section&nbsp;5.1.5.1<span> (</span><span class="info">Limit token scope</span><span>)</span></a>) and expiry time (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#short_exp_time">Section&nbsp;5.1.5.3<span> (</span><span class="info">Short expiration time</span><span>)</span></a>) for issued access tokens can be used to reduce the damage in case of leaks.
</li>
</ul>

<a name="anchor56"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.5.2"></a><h3>4.5.2.&nbsp;
Threat: Obtaining refresh token from authorization server database</h3>

<p>This threat is applicable if the authorization server stores refresh tokens as handles in a database. An attacker may obtain refresh tokens from the authorization server's database by gaining access to the database or launching a SQL injection attack.
</p>
<p>Impact: disclosure of all refresh tokens
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>Credential storage protection - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#cred_storage_prot">Section&nbsp;5.1.4.1<span> (</span><span class="info">Credential Storage Protection</span><span>)</span></a>
</li>
<li>Bind token to client id, if the attacker cannot obtain the required id and secret - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#bind_token_client_id">Section&nbsp;5.1.5.8<span> (</span><span class="info">Bind token to client id</span><span>)</span></a>
</li>
</ul>

<a name="anchor57"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.5.3"></a><h3>4.5.3.&nbsp;
Threat: Obtain refresh token by online guessing</h3>

<p>An attacker may try to guess valid refresh token values and send it using the grant type „refresh_token“ in order to obtain a valid access token.
</p>
<p>Impact: exposure of single refresh token and derivable access tokens.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>For handle-based designs - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#random_entropy">Section&nbsp;5.1.5.11<span> (</span><span class="info">Random token value with high entropy</span><span>)</span></a>
</li>
<li>For assertion-based designs - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#signed_tokens">Section&nbsp;5.1.5.9<span> (</span><span class="info">Signed tokens</span><span>)</span></a>
</li>
<li>Bind token to client id, because the attacker would guess the matching client id, too (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#bind_token_client_id">Section&nbsp;5.1.5.8<span> (</span><span class="info">Bind token to client id</span><span>)</span></a>)
</li>
<li>Authenticate the client, adds another element the attacker has to guess (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#depl_specific_secretes">Section&nbsp;5.2.3.4<span> (</span><span class="info">Deployment-specific client secrets</span><span>)</span></a>)
</li>
</ul>

<a name="anchor58"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.5.4"></a><h3>4.5.4.&nbsp;
Threat: Obtain refresh token phishing by counterfeit authorization server</h3>

<p>An attacker could try to obtain valid refresh tokens by proxying requests to the authorization server. Given the assumption that the authorization server URL is well-known at development time or can at least be obtained from a well-known resource server, the attacker must utilize some kind of spoofing in order to succeed.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>Server authentication (as described in <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#server_authn">Section&nbsp;5.1.2<span> (</span><span class="info">Server authentication</span><span>)</span></a>)
</li>
</ul>

<a name="anchor59"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.6"></a><h3>4.6.&nbsp;
Accessing Protected Resources</h3>

<a name="anchor60"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.6.1"></a><h3>4.6.1.&nbsp;
Threat: Eavesdropping access tokens on transport</h3>

<p>An attacker could try to obtain a valid access token on transport between client and resource server. As access tokens are shared secrets between authorization and resource server, they should be treated with the same care as other credentials (e.g. end-user passwords).
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>Access tokens sent as bearer tokens, should not be sent in the clear over an insecure channel. As per the core OAuth spec, transmission of access tokens must be protected using transport-layer mechanisms such as TLS or SSL (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#conf_requests">Section&nbsp;5.1.1<span> (</span><span class="info">Confidentiality of Requests</span><span>)</span></a>).
</li>
<li>A short lifetime reduces impact in case tokens are compromised (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#short_exp_time">Section&nbsp;5.1.5.3<span> (</span><span class="info">Short expiration time</span><span>)</span></a>).
</li>
<li>The access token can be bound to a client's identity and require the client to prove legitimate ownership of the token to the resource server (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#authn_requests">Section&nbsp;5.4.2<span> (</span><span class="info">Authenticated requests</span><span>)</span></a>).
</li>
</ul>

<a name="anchor61"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.6.2"></a><h3>4.6.2.&nbsp;
Threat: Replay authorized resource server requests</h3>

<p>An attacker could attempt to replay valid requests in order to obtain or to modify/destroy user data.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>The resource server should utilize transport security measure in order to prevent such attacks (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#conf_requests">Section&nbsp;5.1.1<span> (</span><span class="info">Confidentiality of Requests</span><span>)</span></a>). This would prevent the attacker from capturing valid requests.
</li>
<li>Alternatively, the resource server could employ signed requests (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#signed_requests">Section&nbsp;5.4.3<span> (</span><span class="info">Signed requests</span><span>)</span></a>) along with nounces and timestamps in order to uniquely identify requests. The resource server should detect and refuse every replayed request.
</li>
</ul>

<a name="anchor62"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.6.3"></a><h3>4.6.3.&nbsp;
Threat: Guessing access tokens</h3>

<p>Where the token is a handle, the attacker may use attempt to guess the access token values based on knowledge they have from other access tokens.
</p>
<p>Impact: Access to a single user's data.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>Handle Tokens should have a reasonable entropy (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#random_entropy">Section&nbsp;5.1.5.11<span> (</span><span class="info">Random token value with high entropy</span><span>)</span></a>) in order to make guessing a valid token value difficult.
</li>
<li>Assertion (or self-contained token ) tokens contents should be protected by a digital signature (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#signed_tokens">Section&nbsp;5.1.5.9<span> (</span><span class="info">Signed tokens</span><span>)</span></a>).
</li>
<li>Security can be further strengthened by using a short access token duration (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#exp_time">Section&nbsp;5.1.5.2<span> (</span><span class="info">Expiration time</span><span>)</span></a> and <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#short_exp_time">Section&nbsp;5.1.5.3<span> (</span><span class="info">Short expiration time</span><span>)</span></a>).
</li>
</ul>

<a name="anchor63"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.6.4"></a><h3>4.6.4.&nbsp;
Threat: Access token phishing by counterfeit resource server</h3>

<p>An attacker may pretend to be a particular resource server and to accept tokens from a particular authorization server. If the client sends a valid access tokens to this counterfeit resource server, the server in turn may use that token to access other services on behalf of the resource owner.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>Clients should not make authenticated requests with an access token to unfamiliar resource servers, regardless of the presence of a secure channel. If the resource server address is well-known to the client, it may authenticate the resource servers (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#server_authn">Section&nbsp;5.1.2<span> (</span><span class="info">Server authentication</span><span>)</span></a>).
</li>
<li>Associate the endpoint address of the resource server the client talked to with the access token (e.g. in an audience field) and validate association at legitimate resource server. The endpoint address validation policy may be strict (exact match) or more relaxed (e.g. same host). This would require to tell the authorization server the resource server endpoint address in the authorization process.
</li>
<li>Associate an access token with a client and authenticate the client with resource server requests (typically via signature in order to not disclose secret to a potential attacker). This prevents the attack because the counterfeit server is assumed to miss the capabilities to correctly authenticate on behalf of the legitimate client to the resource server (<a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#authn_requests">Section&nbsp;5.4.2<span> (</span><span class="info">Authenticated requests</span><span>)</span></a>).
</li>
<li>Restrict the token scope (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#limit_scope">Section&nbsp;5.1.5.1<span> (</span><span class="info">Limit token scope</span><span>)</span></a>) and or limit the token to a certain resource server (<a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#bind_token_rs">Section&nbsp;5.1.5.5<span> (</span><span class="info">Bind tokens to a particular resource server (Audience)</span><span>)</span></a>).
</li>
</ul>

<a name="anchor64"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.6.5"></a><h3>4.6.5.&nbsp;
Threat: Abuse of token by legitimate resource server or client</h3>

<p>A legitimate resource server could attempt to use an access token to access another resource servers. Similarly, a client could try to use a token obtained for one server on another resource server.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>Tokens should be restricted to particular resource servers (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#bind_token_rs">Section&nbsp;5.1.5.5<span> (</span><span class="info">Bind tokens to a particular resource server (Audience)</span><span>)</span></a>).
</li>
</ul>

<a name="anchor65"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.6.6"></a><h3>4.6.6.&nbsp;
Threat: Leak of confidential data in HTTP-Proxies</h3>

<p>The HTTP Authorization scheme (OAuth HTTP Authorization Scheme) is optional. However, [RFC2616](Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, “Hypertext Transfer Protocol -- HTTP/1.1,” .) relies on the Authorization and WWW-Authenticate headers to distinguish authenticated content so that it can be protected. Proxies and caches, in particular, may fail to adequately protect requests not using these headers. For example, private authenticated content may be stored in (and thus retrievable from) publicly-accessible caches.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>Resource servers not using the HTTP Authorization scheme (OAuth HTTP Authorization Scheme - see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#authz_header">Section&nbsp;5.4.1<span> (</span><span class="info">Authorization headers</span><span>)</span></a>) should take care to use other mechanisms, such as the Cache-Control header, to minimize the risk that authenticated content is not protected.
</li>
<li>Reducing scope (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#limit_scope">Section&nbsp;5.1.5.1<span> (</span><span class="info">Limit token scope</span><span>)</span></a>) and expiry time (<a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#short_exp_time">Section&nbsp;5.1.5.3<span> (</span><span class="info">Short expiration time</span><span>)</span></a>) for access tokens can be used to reduce the damage in case of leaks.
</li>
</ul>

<a name="anchor66"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.4.6.7"></a><h3>4.6.7.&nbsp;
Threat: Token leakage via logfiles and HTTP referrers</h3>

<p>If access tokens are sent via URI query parameters, such tokens may leak to log files and HTTP referrers.
</p>
<p>Countermeasures:
</p>
<p></p>
<ul class="text">
<li>Use authorization headers or POST parameters instead of URI request parameters (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#authz_header">Section&nbsp;5.4.1<span> (</span><span class="info">Authorization headers</span><span>)</span></a>).
</li>
<li>Set logging configuration appropriately
</li>
<li>Prevent unauthorized persons from access to system log files (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#std_sys">Section&nbsp;5.1.4.1.1<span> (</span><span class="info">Standard System Security Means</span><span>)</span></a>)
</li>
<li>HTTP referrers can be prevented by reloading the target page again without URI parameters
</li>
<li>Abuse of leaked access tokens can be prevented by enforcing authenticated requests (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#authn_requests">Section&nbsp;5.4.2<span> (</span><span class="info">Authenticated requests</span><span>)</span></a>).
</li>
<li>The impact of token leakage may be reduced by limiting scope (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#limit_scope">Section&nbsp;5.1.5.1<span> (</span><span class="info">Limit token scope</span><span>)</span></a>) and duration (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#short_exp_time">Section&nbsp;5.1.5.3<span> (</span><span class="info">Short expiration time</span><span>)</span></a>) and enforcing one time token usage (see <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#one_time_usage">Section&nbsp;5.1.5.4<span> (</span><span class="info">Limit number of usages/ One time usage</span><span>)</span></a>).
</li>
</ul>

<a name="security_considerations"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Security Considerations</h3>

<p>This section describes the countermeasures as recommended to mitigate the threats as described in Section 4.
</p>
<a name="anchor67"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
General</h3>

<p>The general section covers consideratios that apply generally across all OAuth components (client, resource server, token server, and user-agents).
</p>
<a name="conf_requests"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.1.1"></a><h3>5.1.1.&nbsp;
Confidentiality of Requests</h3>

<p>This is applicable to all requests sent from client to authorization server or resource server. While OAuth provides a mechanism for verifying the integrity of requests, it provides no guarantee of request confidentiality. Unless further precautions are taken, eavesdroppers will have full access to request content and may be able to mount interception or replay attacks through using content of request, e.g. secrets or tokens.
</p>
<p>Attacks can be mitigated by using transport-layer mechanisms such as TLS or SSL. VPN may considered as well.
</p>
<p>This is a countermeasure against the following threats:
</p>
<p></p>
<ul class="text">
<li>Replay of access tokens obtained on tokens endpoint or resource server's endpoint
</li>
<li>Replay of refresh tokens obtained on tokens endpoint
</li>
<li>Replay of authorization codes obtained on tokens endpoint (redirect?)
</li>
<li>Replay of user passwords and client secrets
</li>
</ul>

<a name="server_authn"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.1.2"></a><h3>5.1.2.&nbsp;
Server authentication</h3>

<p>HTTPS server authentication or similar means can be used to authenticate the identity of a server. The goal is to reliably bind the DNS name of the server to the public key presented by the server during connection establishment.
</p>
<p>The client should validate the binding of the server to its domain name. If the server fails to prove that binding, it is considered a man-in-the-middle attack. The security measure depends on the certification authorities the client trusts for that purpose. Clients should carefully select those trusted CAs and protect the storage for trusted CA certificates from modifications.
</p>
<p>This is a countermeasure against the following threats:
</p>
<p></p>
<ul class="text">
<li>Spoofing
</li>
<li>Proxying
</li>
<li>Phishing by counterfeit servers
</li>
</ul>

<a name="informed"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.1.3"></a><h3>5.1.3.&nbsp;
Always keep the resource owner informed</h3>

<p>Transparency to the resource owner is a key element of the OAuth protocol. The user should always be in control of the authorization processes and get the necessary information to meet informed decisions. Moreover, user involvement is a further security countermeasure. The user can probably recognize certain kinds of attacks better than the authorization server. Information can be presented/exchanged during the authorization process, after the authorization process, and every time the user wishes to get informed by using techniques such as:
</p>
<p></p>
<ul class="text">
<li>User consent forms
</li>
<li>Notification messages (e-Mail, SMS, …)
</li>
<li>Activity/Event logs
</li>
<li>User self-care applications or portals
</li>
</ul>

<a name="anchor68"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.1.4"></a><h3>5.1.4.&nbsp;
Credentials</h3>

<p>This sections describes countermeasures used to protect all kinds of credentials from unauthorized access and abuse. Credentials are long term secrets, such as client secrets and user passwords as well as all kinds of tokens (refresh and access token) or authorization codes.
</p>
<a name="cred_storage_prot"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.1.4.1"></a><h3>5.1.4.1.&nbsp;
Credential Storage Protection</h3>

<p>Administrators should undertake industry best practices to protect the storage of credentials. Such practices may include but are not limited to the following sub-sections.
</p>
<a name="std_sys"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.1.4.1.1"></a><h3>5.1.4.1.1.&nbsp;
Standard System Security Means</h3>

<p>A server system may be locked down so that no attacker may get access to sensible configuration files and databases.
</p>
<a name="std_sql"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.1.4.1.2"></a><h3>5.1.4.1.2.&nbsp;
Standard SQL Injection Countermeasures</h3>

<p>If a client identifier or other authentication component is queried or compared against a SQL Database it may become possible for an injection attack to occur if parameters received are not validated before submission to the database.
</p>
<p></p>
<ul class="text">
<li>Ensure that server code is using the minimum database privileges possible to reduce the "surface" of possible attacks.
</li>
<li>Avoid dynamic SQL using concatenated input. If possible, use static SQL.
</li>
<li>When using dynamic SQL, parameterize queries using bind arguments. Bind arguments eliminate possibility of SQL injections.
</li>
<li>Filter and sanitize the input. For example, if an identifier has a known format, ensure that the supplied value matches the identifier syntax rules.
</li>
</ul>

<a name="noclear"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.1.4.1.3"></a><h3>5.1.4.1.3.&nbsp;
No cleartext storage of credentials</h3>

<p>The authorization server should not store credential in clear text. Typical approaches are to store hashes instead. If the credential lacks a reasonable entropy level (because it is a user password) an additional salt will harden the storage to prevent offline dictionary attacks. Note: Some authentication protocols require the authorization server to have access to the secret in the clear. Those protocols cannot be implemented if the server only has access to hashes.
</p>
<a name="anchor69"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.1.4.1.4"></a><h3>5.1.4.1.4.&nbsp;
Encryption of credentials</h3>

<p>For client applications, insecurely persisted client credentials are easy targets for attackers to obtain. Store client credentials using an encrypted persistence mechanism such as a keystore or database. Note that compiling client credentials directly into client code makes client applications vulnerable to scanning as well as difficult to administer should client credentials change over time.
</p>
<a name="anchor70"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.1.4.1.5"></a><h3>5.1.4.1.5.&nbsp;
Use of asymmetric cryptography</h3>

<p>Usage of asymmetric cryptography will free the authorization server of the obligation to manage credentials.
</p>
<a name="online_secrets"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.1.4.2"></a><h3>5.1.4.2.&nbsp;
Online attacks on secrets</h3>

<a name="pwd_policy"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.1.4.2.1"></a><h3>5.1.4.2.1.&nbsp;
Password policy</h3>

<p>The authorization server may decide to enforce a complex user password policy in order to increase the user passwords' entropy. This will hinder online password attacks.
</p>
<a name="high_entropy"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.1.4.2.2"></a><h3>5.1.4.2.2.&nbsp;
High entropy of secrets</h3>

<p>When creating token handles or other secrets not intended for usage by human users, the authorization server should include a reasonable level of entropy in order to mitigate the risk of guessing attacks.
</p>
<p>The token value should be constructed from a cryptographically strong random or pseudo-random number sequence [RFC1750] generated by the Authorization Server. The probability of any two Authorization Code values being identical should be less than or equal to 2^(-128) and should be less than or equal to 2^(-160).
</p>
<a name="lock_accounts"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.1.4.2.3"></a><h3>5.1.4.2.3.&nbsp;
Lock accounts</h3>

<p>Online attacks on passwords can be mitigated by locking the respective accounts after a certain number of failed attempts.
</p>
<p>Note: This measure can be abused to lock down legitimate service users.
</p>
<a name="tar_pit"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.1.4.2.4"></a><h3>5.1.4.2.4.&nbsp;
Tar pit</h3>

<p>The authorization server may react on failed attempts to authenticate by username/password by temporarily locking the respective account and delaying the response for a certain duration. This duration may increase with the number of failed attempts. The objective is to slow the attackers attempts on a certain username down.
</p>
<p>Note: this may require a more complex and stateful design of the authorization server.
</p>
<a name="captchas"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.1.4.2.5"></a><h3>5.1.4.2.5.&nbsp;
Usage of CAPTCHAs</h3>

<p>The idea is to prevent programs from automatically checking huge number of passwords by requiring human interaction.
</p>
<p>Note: this has a negative impact on user experience.
</p>
<a name="anchor71"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.1.5"></a><h3>5.1.5.&nbsp;
Tokens (access, refresh, code)</h3>

<a name="limit_scope"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.1.5.1"></a><h3>5.1.5.1.&nbsp;
Limit token scope</h3>

<p>The authorization server may decide to reduce or limit the scope associated with a token. Basis of this decision is out of scope, examples are:
</p>
<p></p>
<ul class="text">
<li>a client-specific policy, e.g. issue only less powerful tokens to public clients,
</li>
<li>a service-specific policy, e.g. it a very sensible service,
</li>
<li>a resource-owner specific setting, or
</li>
<li>combinations of such policies and preferences.
</li>
</ul><p>The authorization server may allow different scopes dependent on the grant type. For example, end-user authorization via direct interaction with the end-user (authorization code) might be considered more reliable than direct authorization via grant type username/password. This means will reduce the impact of the following threats:
</p>
<p></p>
<ul class="text">
<li>token leakage
</li>
<li>token issuance to malicious software
</li>
<li>unintended issuance of to powerful tokens with resource owner credentials flow
</li>
</ul>

<a name="exp_time"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.1.5.2"></a><h3>5.1.5.2.&nbsp;
Expiration time</h3>

<p>Tokens should generally expire after a reasonable duration. This complements and strengthens other security measures (such as signatures) and reduces the impact of all kinds of token leaks.
</p>
<a name="short_exp_time"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.1.5.3"></a><h3>5.1.5.3.&nbsp;
Short expiration time</h3>

<p>A short expiration time for tokens is a protection means against the following threats:
</p>
<p></p>
<ul class="text">
<li>replay
</li>
<li>reduce impact of token leak
</li>
<li>reduce likelihood of successful online guessing
</li>
</ul><p>Note: Short token duration requires preciser clock synchronisation between authorization server and resource server. Furthermore, shorter duration may require more token refreshments (access token) or repeated end-user authorization processes (authorization code and refresh token).
</p>
<a name="one_time_usage"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.1.5.4"></a><h3>5.1.5.4.&nbsp;
Limit number of usages/ One time usage</h3>

<p>The authorization server may restrict the number of requests or operations which can be performed with a certain token. This mechanism can be used to mitigate the following threats:
</p>
<p></p>
<ul class="text">
<li>replay of tokens
</li>
<li>reduce likelihood of successful online guessing
</li>
</ul><p>For example, if an Authorization Server observes more than one attempt to redeem a authorization code, the Authorization Server may want to revoke all access tokens granted based on the authorization code as well as reject the current request.
</p>
<p>As with the authorization code, access tokens may also have a limited number of operations. This forces client applications to either re-authenticate and use a refresh token to obtain a fresh access token, or it forces the client to re-authorize the access token by involving the user.
</p>
<a name="bind_token_rs"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.1.5.5"></a><h3>5.1.5.5.&nbsp;
Bind tokens to a particular resource server (Audience)</h3>

<p>Authorization servers in multi-service environments may consider issuing tokens with different content to different resource servers and to explicitly indicate in the token the target server a token is intended to be sent to (see Audience in SAML Assertions). This countermeasure can be used in the following situations:
</p>
<p></p>
<ul class="text">
<li>It reduces the impact of a successful replay attempt, since the token is applicable to a single resource server, only.
</li>
<li>It prevents abuse of a token by a rough resource server or client, since the token can only be used on that server. It is rejected by other servers.
</li>
<li>It reduces the impact of a leakage of a valid token to a counterfeit resource server.
</li>
</ul>

<a name="endpoint_audience"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.1.5.6"></a><h3>5.1.5.6.&nbsp;
Use endpoint address as token audience</h3>

<p>This may be used to indicate to a resource server, which endpoint address has been used to obtain the token. This measure will allow to detect requests from a counterfeit resource server, since such token will contain the endpoint address of that server.
</p>
<a name="audience_token_scope"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.1.5.7"></a><h3>5.1.5.7.&nbsp;
Audience and Token scopes</h3>

<p>Deployments may consider only using tokens with explicitly defined scope, where every scope is associated with a particular resource server. This approach can be used to mitigate attacks, where a resource server or client uses a token for a different then the intended purpose.
</p>
<a name="bind_token_client_id"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.1.5.8"></a><h3>5.1.5.8.&nbsp;
Bind token to client id</h3>

<p>An authorization server may bind a token to a certain client identity. This identity should be validated for every request with that token. This means can be used, to
</p>
<p></p>
<ul class="text">
<li>detect token leakage and
</li>
<li>prevent token abuse.
</li>
</ul><p>Note: Validating the client identity may require the target server to authenticate the client's identity. This authentication can be based on secrets managed independent of the token (e.g. pre-registered client id/secret on authorization server) or sent with the token itself (e.g. as part of the encrypted token content).
</p>
<a name="signed_tokens"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.1.5.9"></a><h3>5.1.5.9.&nbsp;
Signed tokens</h3>

<p>Self-contained tokens should be signed in order to detect any attempt to modify or produce faked tokens.
</p>
<a name="enc_token"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.1.5.10"></a><h3>5.1.5.10.&nbsp;
Encryption of token content</h3>

<p>Self-contained may be encrypted for privacy reasons or to protect system internal data.
</p>
<a name="random_entropy"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.1.5.11"></a><h3>5.1.5.11.&nbsp;
Random token value with high entropy</h3>

<p>When creating token handles, the authorization server should include a reasonable level of entropy in order to mitigate the risk of guessing attacks. The token value should be constructed from a cryptographically strong random or pseudo-random number sequence [RFC1750] generated by the Authorization Server. The probability of any two token values being identical should be less than or equal to 2^(-128) and should be less than or equal to 2^(-160).
</p>
<a name="anchor72"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.1.5.12"></a><h3>5.1.5.12.&nbsp;
Assertion formats</h3>

<p>For service providers intending to implement an assertion-based token design it is highly recommended to adopt a standard assertion format (such as SAML or JWT) that implements [draft-ietf-oauth-assertions].
</p>
<a name="access_tokens"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.1.6"></a><h3>5.1.6.&nbsp;
Access tokens</h3>

<p>The following measures should be used to protect access tokens
</p>
<p></p>
<ul class="text">
<li>keep them in transient memory (accessible by the client application only)
</li>
<li>protect from exposure to 3rd parties (malicious application)
</li>
<li>limit number of access tokens granted to a user
</li>
</ul>

<a name="anchor73"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Authorization Server</h3>

<p>This section describes considerations related to the OAuth Authorization Server end-point.
</p>
<a name="anchor74"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.2.1"></a><h3>5.2.1.&nbsp;
Authorization Codes</h3>

<a name="automatic_code_revocation"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.2.1.1"></a><h3>5.2.1.1.&nbsp;
Automatic revocation of derived tokens if abuse is detected</h3>

<p>If an Authorization Server observes multiple attempts to redeem an authorization grant (e.g. such as an authorization code), the Authorization Server may want to revoke all tokens granted based on the authorization grant.
</p>
<a name="refresh_tokens"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.2.2"></a><h3>5.2.2.&nbsp;
Refresh tokens</h3>

<a name="restricted_refresh"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.2.2.1"></a><h3>5.2.2.1.&nbsp;
Restricted issuance of refresh tokens</h3>

<p>The authorization server may decide based on an appropriate policy not to issue refresh tokens. Since refresh tokens are long term credentials, they may be subject theft. For example, if the authorization server does not trust a client to securely store such tokens, it may refuse to issue such a client a refresh token.
</p>
<a name="binding_refresh_client_id"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.2.2.2"></a><h3>5.2.2.2.&nbsp;
Binding of refresh token to client_id</h3>

<p>The authorization server should bind every refresh token to the id of the client such a token was originally issued to and validate this binding for every request to refresh that token. If possible (e.g. confidential clients), the authorization server should authenticate the respective client.
</p>
<p>This is a countermeasure against refresh token theft or leakage.
</p>
<p>Note: This binding should be protected from unauthorized modifications.
</p>
<a name="refresh_replace"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.2.2.3"></a><h3>5.2.2.3.&nbsp;
Refresh Token Rotation</h3>

<p>Refresh token rotation is intended to automatically detect and prevent attempts to use the same refresh token in parallel from different apps/devices. This happens if a token gets stolen from the client and is subsequently used by the attacker and the legitimate client. The basic idea is to change the refresh token value with every refresh request in order to detect attempts to obtain access tokens using old refresh tokens. Since the authorization server cannot determine whether the attacker or the legitimate client is trying to access, in case of such an access attempt the valid refresh token and the access authorization associated with it are both revoked.
</p>
<p>The OAuth specification supports this measure in that the tokens response allows the authorization server to return a new refresh token even for requests with grant type "refresh_token“.
</p>
<p>Note: this measure may cause problems in clustered environments since usage of the currently valid refresh token must be ensured. In such an environment, other measures might be more appropriate.
</p>
<a name="refresh_revocation"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.2.2.4"></a><h3>5.2.2.4.&nbsp;
Refresh Token Revocation</h3>

<p>The authorization server may allow clients or end-users to explicitly request the invalidation of refresh tokens.
</p>
<p>This is a countermeasure against:
</p>
<p></p>
<ul class="text">
<li>device theft,
</li>
<li>impersonation of resource owner, or
</li>
<li>suspected compromised client applications.
</li>
</ul>

<a name="device_id"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.2.2.5"></a><h3>5.2.2.5.&nbsp;
Device identification</h3>

<p>The authorization server may require to bind authentication credentials to a device identifier. The IMEI is one example of such an identifier, there are also operating system specific identifiers. The authorization server could include such an identifier when authenticating user credentials in order to detect token theft from a particular device.
</p>
<a name="clickjacking_xframe"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.2.2.6"></a><h3>5.2.2.6.&nbsp;
X-FRAME-OPTION header</h3>

<p>For newer browsers, avoidance of iFrames can be enforced server side by using the X-FRAME-OPTION header. This header can have two values, deny and same origin, which will block any framing or framing by sites with a different origin, respectively.
</p>
<p>This is a countermeasure against the following threats:
</p>
<p></p>
<ul class="text">
<li>Clickjacking attacks
</li>
</ul>

<a name="client_aa"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.2.3"></a><h3>5.2.3.&nbsp;
Client authentication and authorization</h3>

<p>As described in Section 3 (Security Features), clients are identified, authenticated and authorized for several purposes, such as a
</p>
<p></p>
<ul class="text">
<li>Collate sub-sequent requests to the same client,
</li>
<li>Indicate the trustworthiness of a particular client to the end-user,
</li>
<li>Authorize access of clients to certain features on the authorization or resource server, and
</li>
<li>Log a client identity to log files for analysis or statics.
</li>
</ul><p>Due to the different capabilities and characteristics of the different client types, there are different ways to support achieve objectives, which will be described in this section. Authorization server providers should be aware of the security policy and deployment of a particular clients and adapt its treatment accordingly. For example, one approach could be to treat all clients as less trustworthy and unsecure. On the other extreme, a service provider could activate every client installation by hand of an administrator and that way gain confidence in the identity of the software package and the security of the environment the client is installed in. And there are several approaches in between.
</p>
<a name="dont_issue"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.2.3.1"></a><h3>5.2.3.1.&nbsp;
Don't issue secrets to public clients or clients with inappropriate security policy</h3>

<p>Authorization servers should not issue secrets to "public" clients that cannot protect secrets. This prevents the server from overestimating the value of a successful authentication of the client.
</p>
<p>For example, it is of limited benefit to create a single client id and secret which is shared by all installations of a native application. Such a scenario requires that this secret must be transmitted from the developer via the respective distribution channel, e.g. an application market, to all installations of the application on end-user devices. A secret, burned into the source code of the application or a associated resource bundle, cannot be entirely protected from reverse engineering. Secondly, such secrets cannot be revoked since this would immediately put all installations out of work. Moreover, since the authorization server cannot really trust on the client's identity, it would be dangerous to indicate to end-users the trustworthiness of the client.
</p>
<p>There are other ways to achieve a reasonable security level, as described in the following sections.
</p>
<a name="forced_user_consent"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.2.3.2"></a><h3>5.2.3.2.&nbsp;
Public clients without secret require user consent</h3>

<p>Authorization servers should not allow automatic authorization for public clients. The authorization may issue a client id, but should require that all authorizations are approved by the end-user. This is a countermeasure for clients without secret against the following threats:
</p>
<p></p>
<ul class="text">
<li>Impersonation of public client applications
</li>
</ul>

<a name="client_id_redirect"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.2.3.3"></a><h3>5.2.3.3.&nbsp;
Client_id only in combination with redirect_uri</h3>

<p>The authorization may issue a client_id and bind the client_id to a certain pre-configured redirect_uri. Any authorization request with another redirection URI is refused automatically. Alternatively, the authorization server should not accept any dynamic redirection URI for such a client_id and instead always redirect to the well-known pre-configured redirection URI. This is a countermeasure for clients without secrets against the following threats:
</p>
<p></p>
<ul class="text">
<li>Cross-site scripting attacks
</li>
<li>Impersonation of public client applications
</li>
</ul>

<a name="depl_specific_secretes"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.2.3.4"></a><h3>5.2.3.4.&nbsp;
Deployment-specific client secrets</h3>

<p>A authorization server may issue separate client identifiers and corresponding secrets to the different deployments of a client. The effect of such an approach would be to turn otherwise "public" clients back into "confidential" clients.
</p>
<p>For web applications, this could mean to create one client_id and client_secret per web site a software package is installed on. So the provider of that particular site could request client id and secret from the authorization server during setup of the web site. This would also allow to validate some of the properties of that web site, such as redirection URI, address, and whatever proofs useful. The web site provider has to ensure the security of the client secret on the site.
</p>
<p>For native applications, things are more complicated because every installation of the application on any device is another deployment. Deployment specific secrets will require
</p>
<p></p>
<ol class="text">
<li>Either to obtain a client_id and client_secret during download process from the application market, or
</li>
<li>During installation on the device.
</li>
</ol><p>Either approach will require an automated mechanism for issuing client ids and secrets, which is currently not defined by OAuth.
</p>
<p>The first approach would allow to achieve a level where the client is authenticated and identified, whereas the second option only allows to authenticate the client but not to validate properties of the client. But this would at least help to prevent several replay attacks. Moreover, deployment-specific client_id and secret allow to selectively revoke all refresh tokens of a specific deployment at once.
</p>
<a name="val_redirect"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.2.3.5"></a><h3>5.2.3.5.&nbsp;
Validation of pre-registered redirect_uri</h3>

<p>An authorization server should require all clients to register their redirect_uri and the redirect_uri should be the full URI as defined in <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#I-D.ietf-oauth-v2">[I‑D.ietf‑oauth‑v2]<span> (</span><span class="info">Hammer, E., Recordon, D., and D. Hardt, “The OAuth 2.0 Authorization Protocol,” January&nbsp;2012.</span><span>)</span></a>. The way this registration is performed is out of scope of this document. As per the core spec, every actual redirection URI sent with the respective client_id to the end-user authorization endpoint must match the registered redirection URI. Where it does not match, the authorization server should assume the inbound GET request has been sent by an attacker and refuse it. Note: the authorization server should not redirect the user agent back to the redirection URI of such an authorization request.
</p>
<p></p>
<ul class="text">
<li>Authorization code leakage through counterfeit web site: allows to detect attack attempts already after first redirect to end-user authorization endpoint (<a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#authz_code_leakage">Section&nbsp;4.4.1.7<span> (</span><span class="info">Threat: Authorization code leakage through counterfeit client</span><span>)</span></a>).
</li>
<li>For clients with validated properties, this measure also helps to detect malicious applications early in the end-user authorization process. This reduces the need for a interactive validation by the user (<a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#mal_client">Section&nbsp;4.4.1.4<span> (</span><span class="info">Threat: Malicious client obtains authorization</span><span>)</span></a>, <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#mal_client2">Section&nbsp;4.4.2.3<span> (</span><span class="info">Threat: Malicious client obtains authorization</span><span>)</span></a>).
</li>
<li>Open Redirector attack via client redirection endpoint. ( <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#open_redirector_client">Section&nbsp;4.1.5<span> (</span><span class="info">Threat: Open Redirectors on client</span><span>)</span></a>. )
</li>
<li>Open Redirector phishing attack via authorization server redirection endpoint ( <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#open_redirector">Section&nbsp;4.2.4<span> (</span><span class="info">Threat: Open redirector</span><span>)</span></a> )
</li>
</ul><p> The underlying assumption of this measure is that an attacker will need to use another redirection URI in order to get access to the authorization code. Deployments might consider the possibility of an attacker using spoofing attacks to a victims device to circumvent this security measure.
</p>
<p>Note: Pre-registering clients might not scale in some deployments (manual process) or require dynamic client registration (not specified yet). With the lack of dynamic client registration, it only works for clients bound to certain deployments at development/configuration time. As soon as dynamic resource server discovery gets involved, that's no longer feasible.
</p>
<a name="client_secret_revocation"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.2.3.6"></a><h3>5.2.3.6.&nbsp;
Client secret revocation</h3>

<p>An authorization server may revoke a client's secret in order to prevent abuse of a revealed secret.
</p>
<p>Note: This measure will immediately invalidate any authorization code or refresh token issued to the respective client. This might be unintentionally for client identifiers and secrets used across multiple deployments of a particular native or web application.
</p>
<p>This a countermeasure against:
</p>
<p></p>
<ul class="text">
<li>Abuse of revealed client secrets for private clients
</li>
</ul>

<a name="strong_client_authn"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.2.3.7"></a><h3>5.2.3.7.&nbsp;
Use strong client authentication (e.g. client_assertion / client_token)</h3>

<p>By using an alternative form of authentication such as client assertion [draft-ietf-oauth-assertions], the need to distribute client_secret is eliminated. This may require the use of a secure private key store or other supplemental authentication system as specified by the client assertion issuer in its authentication process.
</p>
<a name="anchor75"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.2.4"></a><h3>5.2.4.&nbsp;
End-user authorization</h3>

<p>This secion involves considerations for authorization flows involving the end-user.
</p>
<a name="automatic_processing"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.2.4.1"></a><h3>5.2.4.1.&nbsp;
Automatic processing of repeated authorizations requires client validation</h3>

<p>Authorization servers should NOT automatically process repeat authorizations where the client is not authenticated through a client secret or some other authentication mechanism such as signing with security certificates (5.7.2.7. Use strong client authentication (e.g. client_assertion / client_token)) or validation of a pre-registered redirect URI (5.7.2.5. Validation of pre-registered redirection URI ).
</p>
<a name="informed_decisions"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.2.4.2"></a><h3>5.2.4.2.&nbsp;
Informed decisions based on transparency</h3>

<p>The authorization server should clearly explain to the end-user what happens in the authorization process and what the consequences are. For example, the user should understand what access he is about to grant to which client for what duration. It should also be obvious to the user, whether the server is able to reliably certify certain client properties (web site address, security policy).
</p>
<a name="validation_end_user"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.2.4.3"></a><h3>5.2.4.3.&nbsp;
Validation of client properties by end-user</h3>

<p>In the authorization process, the user is typically asked to approve a client's request for authorization. This is an important security mechanism by itself because the end-user can be involved in the validation of client properties, such as whether the client name known to the authorization server fits the name of the web site or the application the end-user is using. This measure is especially helpful in all situation where the authorization server is unable to authenticate the client. It is a countermeasure against:
</p>
<p></p>
<ul class="text">
<li>Malicious application
</li>
<li>A client application masquerading as another client
</li>
</ul>

<a name="bind_code_client_id"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.2.4.4"></a><h3>5.2.4.4.&nbsp;
Binding of authorization code to client_id</h3>

<p>The authorization server should bind every authorization code to the id of the respective client which initiated the end-user authorization process. This measure is a countermeasure against:
</p>
<p></p>
<ul class="text">
<li>replay of authorization codes with different client credentials since an attacker cannot use another client_id to exchange an authorization code into a token
</li>
<li>Online guessing of authorization codes
</li>
</ul><p>Note: This binding should be protected from unauthorized modifications.
</p>
<a name="bind_code_redirect"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.2.4.5"></a><h3>5.2.4.5.&nbsp;
Binding of authorization code to redirect_uri</h3>

<p>The authorization server should bind every authorization code to the actual redirection URI used as redirect target of the client in the end-user authorization process. This binding should be validated when the client attempts to exchange the respective authorization code for an access token. This measure is a countermeasure against authorization code leakage through counterfeit web sites since an attacker cannot use another redirection URI to exchange an authorization code into a token.
</p>
<a name="anchor76"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
Client App Security</h3>

<p>This section deals with considerations for client applications.
</p>
<a name="cred_software"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.3.1"></a><h3>5.3.1.&nbsp;
Don't store credentials in code or resources bundled with software packages</h3>

<p>Because of the numbers of copies of client software, there is limited benefit to create a single client id and secret which is shared by all installations of an application. Such an application by itself would be considered a "public" client as it cannot be presumed to be able to keep client secrets. A secret, burned into the source code of the application or a associated resource bundle, cannot be entirely protected from reverse engineering. Secondly, such secrets cannot be revoked since this would immediately put all installations out of work. Moreover, since the authorization server cannot really trust on the client's identity, it would be dangerous to indicate to end-users the trustworthiness of the client.
</p>
<a name="std_web"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.3.2"></a><h3>5.3.2.&nbsp;
Standard web server protection measures (for config files and databases)</h3>

<p>Use standard web server protection measures - <a class="info" href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#std_web">Section&nbsp;5.3.2<span> (</span><span class="info">Standard web server protection measures (for config files and databases)</span><span>)</span></a>
</p>
<a name="secure_storage"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.3.3"></a><h3>5.3.3.&nbsp;
Store secrets in a secure storage</h3>

<p>The are different way to store secrets of all kinds (tokens, client secrets) securely on a device or server.
</p>
<p>Most multi-user operation systems segregate the personal storage of the different system users. Moreover, most modern smartphone operating systems even support to store app-specific data in separate areas of the file systems and protect it from access by other applications. Additionally, applications can implements confidential data itself using a user-supplied secret, such as PIN or password.
</p>
<p>Another option is to swap refresh token storage to a trusted backend server. This mean in turn requires a resilient authentication mechanisms between client and backend server. Note: Applications should ensure that confidential data is kept confidential even after reading from secure storage, which typically means to keep this data in the local memory of the application.
</p>
<a name="device_lock"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.3.4"></a><h3>5.3.4.&nbsp;
Utilize device lock to prevent unauthorized device access</h3>

<p>On a typical modern phone, there are many "device lock" options which can be utilized to provide additional protection where a device is stolen or misplaced. These include PINs, passwords and other biomtric featres such as "face recognition". These are not equal in their level of security they provide.
</p>
<a name="anchor77"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.3.5"></a><h3>5.3.5.&nbsp;
Platform security measures</h3>

<p></p>
<ul class="text">
<li>Validation process
</li>
<li>software package signatures
</li>
<li>Remote removal
</li>
</ul>

<a name="link_state_uasession"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.3.6"></a><h3>5.3.6.&nbsp;
Link state parameter to user agent session</h3>

<p>The state parameter is used to link client requests and prevent CSRF attacks, for example against the redirection URI. An attacker could inject their own authorization code or access token, which can result in the client using an access token associated with the attacker's protected resources rather than the victim's (e.g. save the victim's bank account information to a protected resource controlled by the attacker).
</p>
<p>The client should utilize the "state" request parameter to send the authorization server a value that binds the request to the user-agent's authenticated state (e.g. a hash of the session cookie used to authenticate the user-agent) when making an authorization request. Once authorization has been obtained from the end-user, the authorization server redirects the end-user's user-agent back to the client with the required binding value contained in the "state" parameter.
</p>
<p>The binding value enables the client to verify the validity of the request by matching the binding value to the user- agent's authenticated state.
</p>
<a name="anchor78"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
Resource Servers</h3>

<p>The following section details security considerations for resource servers.
</p>
<a name="authz_header"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.4.1"></a><h3>5.4.1.&nbsp;
Authorization headers</h3>

<p>Authorization headers are recognized and specially treated by HTTP proxies and servers. Thus the usage of such headers for sending access tokens to resource servers reduces the likelihood of leakage or unintended storage of authenticated requests in general and especially Authorization headers.
</p>
<a name="authn_requests"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.4.2"></a><h3>5.4.2.&nbsp;
Authenticated requests</h3>

<p>An authorization server may bind tokens to a certain client identity and encourage resource servers to validate that binding. This will require the resource server to authenticate the originator of a request as the legitimate owner of a particular token. There are a couple of options to implement this countermeasure:
</p>
<p></p>
<ul class="text">
<li>The authorization server may associate the distinguished name of the client with the token (either internally or in the payload of an self-contained token). The client then uses client certificate-based HTTP authentication on the resource server's endpoint to authenticate its identity and the resource server validates the name with the name referenced by the token.
</li>
<li>same as before, but the client uses his private key to sign the request to the resource server (public key is either contained in the token or sent along with the request)
</li>
<li>Alternatively, the authorization server may issue a token-bound secret, which the client uses to sign the request. The resource server obtains the secret either directly from the authorization server or it is contained in an encrypted section of the token. That way the resource server does not "know" the client but is able to validate whether the authorization server issued the token to that client
</li>
</ul><p>This mechanisms is a countermeasure against abuse of tokens by counterfeit resource servers.
</p>
<a name="signed_requests"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.5.4.3"></a><h3>5.4.3.&nbsp;
Signed requests</h3>

<p>A resource server may decide to accept signed requests only, either to replace transport level security measures or to complement such measures. Every signed request should be uniquely identifiable and should not be processed twice by the resource server. This countermeasure helps to mitigate:
</p>
<p></p>
<ul class="text">
<li>modifications of the message and
</li>
<li>replay attempts
</li>
</ul>

<a name="IANA"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
IANA Considerations</h3>

<p>This document makes no request of IANA.
</p>
<p>Note to RFC Editor: this section may be removed on publication as an RFC.
</p>
<a name="Acknowledgements"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Acknowledgements</h3>

<p>We would like to thank Hui-Lan Lu, Francisco Corella, Peifung E Lam, Shane B Weeden, Skylar Woodward, Niv Steingarten, Tim Bray, and James H. Manger for their comments and contributions.
</p>
<a name="rfc.references"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
References</h3>

<a name="rfc.references1"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<h3>8.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tbody><tr><td class="author-text" valign="top"><a name="I-D.ietf-oauth-v2">[I-D.ietf-oauth-v2]</a></td>
<td class="author-text">Hammer, E., Recordon, D., and D. Hardt, “<a href="http://tools.ietf.org/html/draft-ietf-oauth-v2-23">The OAuth 2.0 Authorization Protocol</a>,” draft-ietf-oauth-v2-23 (work in progress), January&nbsp;2012 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-oauth-v2-23.txt">TXT</a>, <a href="http://www.ietf.org/internet-drafts/draft-ietf-oauth-v2-23.pdf">PDF</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, “<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,” BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
</tbody></table>

<a name="rfc.references2"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<h3>8.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tbody><tr><td class="author-text" valign="top"><a name="I-D.ietf-oauth-v2-bearer">[I-D.ietf-oauth-v2-bearer]</a></td>
<td class="author-text">Jones, M., Hardt, D., and D. Recordon, “<a href="http://tools.ietf.org/html/draft-ietf-oauth-v2-bearer-17">The OAuth 2.0 Authorization Protocol: Bearer Tokens</a>,” draft-ietf-oauth-v2-bearer-17 (work in progress), February&nbsp;2012 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-oauth-v2-bearer-17.txt">TXT</a>, <a href="http://www.ietf.org/internet-drafts/draft-ietf-oauth-v2-bearer-17.pdf">PDF</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-oauth-v2-http-mac">[I-D.ietf-oauth-v2-http-mac]</a></td>
<td class="author-text">Hammer-Lahav, E., “<a href="http://tools.ietf.org/html/draft-ietf-oauth-v2-http-mac-01">HTTP Authentication: MAC Access Authentication</a>,” draft-ietf-oauth-v2-http-mac-01 (work in progress), February&nbsp;2012 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-oauth-v2-http-mac-01.txt">TXT</a>, <a href="http://www.ietf.org/internet-drafts/draft-ietf-oauth-v2-http-mac-01.pdf">PDF</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.lodderstedt-oauth-revocation">[I-D.lodderstedt-oauth-revocation]</a></td>
<td class="author-text">Lodderstedt, T., Dronia, S., and M. Scurtescu, “<a href="http://tools.ietf.org/html/draft-lodderstedt-oauth-revocation-03">Token Revocation</a>,” draft-lodderstedt-oauth-revocation-03 (work in progress), September&nbsp;2011 (<a href="http://www.ietf.org/internet-drafts/draft-lodderstedt-oauth-revocation-03.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="portable-contacts">[portable-contacts]</a></td>
<td class="author-text">Smarr, J., “Portable Contacts 1.0 Draft C,” August&nbsp;2008.</td></tr>
</tbody></table>

<a name="anchor81"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Document History</h3>

<p>[[ to be removed by RFC editor before publication as an RFC ]]
</p>
<p>draft-lodderstedt-oauth-security-01
</p>
<p></p>
<ul class="text">
<li>section 4.4.1.2 - changed "resource server" to "client" in countermeasures description.
</li>
<li>section 4.4.1.6 - changed "client shall authenticate the server" to "The browser shall be utilized to authenticate the redirection URI of the client"
</li>
<li>section 5 - general review and alignment with public/confidential client terms
</li>
<li>all sections - general clean-up and typo corrections
</li>
</ul>

<p>draft-ietf-oauth-v2-threatmodel-00
</p>
<p></p>
<ul class="text">
<li>section 3.4 - added the purposes for using authorization codes.
</li>
<li>extended section 4.4.1.1
</li>
<li>merged 4.4.1.5 into 4.4.1.2
</li>
<li>corrected some typos
</li>
<li>reformulated "session fixation", renamed respective sections into "authorization code disclosure through counterfeit client"
</li>
<li>added new section "User session impersonation"
</li>
<li>worked out or reworked sections 2.3.3, 4.4.2.4, 4.4.4, 5.1.4.1.2, 5.1.4.1.4, 5.2.3.5
</li>
<li>added new threat "DoS using manufactured authorization codes" as proposed by Peifung E Lam
</li>
<li>added XSRF and clickjacking (incl. state parameter explanation)
</li>
<li>changed sub-section order in section 4.4.1
</li>
<li>incorporated feedback from Skylar Woodward (client secrets) and Shane B Weeden (refresh tokens as client instance secret)
</li>
<li>aligned client section with core draft's client type definition
</li>
<li>converted I-D into WG document
</li>
</ul>

<p>draft-ietf-oauth-v2-threatmodel-01
</p>
<p></p>
<ul class="text">
<li>Alignment of terminology with core draft 22 (private/public client, redirect URI validation policy, replaced definition of the client categories by reference to respective core section)
</li>
<li>Synchronisation with the core's security consideration section (UPDATE 10.12 CSRF, NEW 10.14/15)
</li>
<li>Added Resource Owner Impersonation
</li>
<li>Improved section 5
</li>
<li>Renamed Refresh Token Replacement to Refresh Token Rotation
</li>
</ul>

<p>draft-ietf-oauth-v2-threatmodel-02
</p>
<p></p>
<ul class="text">
<li>Incoporated Tim Bray's review comments (e.g. removed all normative language)
</li>
</ul>

<a name="rfc.authors"></a><br><hr>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tbody><tr><td class="TOCbug"><a href="file:///C:/Users/tolo/AppData/Local/Temp/xml2rfc-xxe-6025404496400656160.html#toc">&nbsp;TOC&nbsp;</a></td></tr></tbody></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tbody><tr><td class="author-text">&nbsp;</td>
<td class="author-text">Torsten Lodderstedt (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Deutsche Telekom AG</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:torsten@lodderstedt.net">torsten@lodderstedt.net</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Mark McGloin</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">IBM</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:mark.mcgloin@ie.ibm.com">mark.mcgloin@ie.ibm.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Phil Hunt</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Oracle Corporation</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:phil.hunt@yahoo.com">phil.hunt@yahoo.com</a></td></tr>
</tbody></table>

</body></html>